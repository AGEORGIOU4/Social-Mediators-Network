/*! For license information please see 6.edc0381d.chunk.js.LICENSE.txt */
(this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]||[]).push([[6],{542:function(t,e,n){t.exports=n(403)},543:function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,u,"next",t)}function u(t){r(o,i,a,s,u,"throw",t)}s(void 0)}))}}n.d(e,"a",(function(){return i}))},544:function(t,e,n){"use strict";var r=n(574);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"c",(function(){return r.c})),n.d(e,"d",(function(){return r.d})),n.d(e,"e",(function(){return r.e})),n.d(e,"f",(function(){return r.f})),n.d(e,"g",(function(){return r.g}))},547:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(566);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t,e)||Object(r.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},549:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(566);function i(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(r.a)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}},550:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return I})),n.d(e,"c",(function(){return T})),n.d(e,"d",(function(){return j})),n.d(e,"e",(function(){return N})),n.d(e,"f",(function(){return d})),n.d(e,"g",(function(){return A})),n.d(e,"h",(function(){return D})),n.d(e,"i",(function(){return p})),n.d(e,"j",(function(){return y})),n.d(e,"k",(function(){return m})),n.d(e,"l",(function(){return b})),n.d(e,"m",(function(){return O})),n.d(e,"n",(function(){return v})),n.d(e,"o",(function(){return g})),n.d(e,"p",(function(){return w})),n.d(e,"q",(function(){return k})),n.d(e,"r",(function(){return E}));n(549),n(547);var r=n(180),i=n(174),a=n(175),o=n(587),s=n(172),u=n(173),c=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var a=t[i],o=i+1<t.length,s=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=a>>2,h=(3&a)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{var s=t[n++],u=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var a=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){return function(t){var e=c(t);return l.encodeByteArray(e,!0)}(t).replace(/\./g,"")};var f=function(){function t(){var e=this;Object(s.a)(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return Object(u.a)(t,[{key:"wrapCallback",value:function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}}}]),t}();function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(a)),""].join(".")}function p(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())}function y(){var t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function g(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function m(){return p().indexOf("Electron/")>=0}function b(){var t=p();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function k(){return p().indexOf("MSAppHost/")>=0}function w(){return!function(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function O(){return"object"===typeof indexedDB}function E(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(a){e(a)}}))}function j(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}var T=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t,i,a){var o;return Object(s.a)(this,n),(o=e.call(this,i)).code=t,o.customData=a,o.name="FirebaseError",Object.setPrototypeOf(Object(r.a)(o),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Object(r.a)(o),I.prototype.create),o}return n}(Object(o.a)(Error)),I=function(){function t(e,n,r){Object(s.a)(this,t),this.service=e,this.serviceName=n,this.errors=r}return Object(u.a)(t,[{key:"create",value:function(t){var e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),r=this.errors[t],i=r?S(r,e):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,")."),o=new T(n,a,e);return o}}]),t}();function S(t,e){return t.replace(x,(function(t,n){var r=e[n];return null!=r?String(r):"<".concat(n,"?>")}))}var x=/\{\$([^}]+)}/g;function A(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=t[o],u=e[o];if(C(s)&&C(u)){if(!A(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function C(t){return null!==t&&"object"===typeof t}var _=144e5;function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(_,r+i)}function D(t){return t&&t._delegate?t._delegate:t}}).call(this,n(51))},551:function(t,e,n){"use strict";n.d(e,"a",(function(){return x})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return w})),n.d(e,"d",(function(){return E})),n.d(e,"e",(function(){return C})),n.d(e,"f",(function(){return A})),n.d(e,"g",(function(){return _}));n(542),n(543);var r,i,a=n(549),o=n(179),s=n(172),u=n(173),c=n(557),l=n(567),h=n(550),f=function(){function t(e){Object(s.a)(this,t),this.container=e}return Object(u.a)(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((function(t){return t})).join(" ")}}]),t}();var d="@firebase/app",p="0.7.4",v=new l.b("@firebase/app"),y="[DEFAULT]",g=(r={},Object(o.a)(r,d,"fire-core"),Object(o.a)(r,"@firebase/app-compat","fire-core-compat"),Object(o.a)(r,"@firebase/analytics","fire-analytics"),Object(o.a)(r,"@firebase/analytics-compat","fire-analytics-compat"),Object(o.a)(r,"@firebase/app-check","fire-app-check"),Object(o.a)(r,"@firebase/app-check-compat","fire-app-check-compat"),Object(o.a)(r,"@firebase/auth","fire-auth"),Object(o.a)(r,"@firebase/auth-compat","fire-auth-compat"),Object(o.a)(r,"@firebase/database","fire-rtdb"),Object(o.a)(r,"@firebase/database-compat","fire-rtdb-compat"),Object(o.a)(r,"@firebase/functions","fire-fn"),Object(o.a)(r,"@firebase/functions-compat","fire-fn-compat"),Object(o.a)(r,"@firebase/installations","fire-iid"),Object(o.a)(r,"@firebase/installations-compat","fire-iid-compat"),Object(o.a)(r,"@firebase/messaging","fire-fcm"),Object(o.a)(r,"@firebase/messaging-compat","fire-fcm-compat"),Object(o.a)(r,"@firebase/performance","fire-perf"),Object(o.a)(r,"@firebase/performance-compat","fire-perf-compat"),Object(o.a)(r,"@firebase/remote-config","fire-rc"),Object(o.a)(r,"@firebase/remote-config-compat","fire-rc-compat"),Object(o.a)(r,"@firebase/storage","fire-gcs"),Object(o.a)(r,"@firebase/storage-compat","fire-gcs-compat"),Object(o.a)(r,"@firebase/firestore","fire-fst"),Object(o.a)(r,"@firebase/firestore-compat","fire-fst-compat"),Object(o.a)(r,"fire-js","fire-js"),Object(o.a)(r,"firebase","fire-js-all"),r),m=new Map,b=new Map;function k(t,e){try{t.container.addComponent(e)}catch(n){v.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function w(t){var e=t.name;if(b.has(e))return v.debug("There were multiple attempts to register component ".concat(e,".")),!1;b.set(e,t);var n,r=Object(a.a)(m.values());try{for(r.s();!(n=r.n()).done;){k(n.value,t)}}catch(i){r.e(i)}finally{r.f()}return!0}function O(t,e){return t.container.getProvider(e)}function E(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;O(t,e).clearInstance(n)}var j,T=(i={},Object(o.a)(i,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),Object(o.a)(i,"bad-app-name","Illegal App name: '{$appName}"),Object(o.a)(i,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),Object(o.a)(i,"app-deleted","Firebase App named '{$appName}' already deleted"),Object(o.a)(i,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Object(o.a)(i,"invalid-log-argument","First argument to `onLog` must be null or a function."),i),I=new h.b("app","Firebase",T),S=function(){function t(e,n,r){var i=this;Object(s.a)(this,t),this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new c.a("app",(function(){return i}),"PUBLIC"))}return Object(u.a)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(t){this._isDeleted=t}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw I.create("app-deleted",{appName:this._name})}}]),t}(),x="9.1.3";function A(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==typeof e){var n=e;e={name:n}}var r=Object.assign({name:y,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!==typeof i||!i)throw I.create("bad-app-name",{appName:String(i)});var o=m.get(i);if(o){if(Object(h.g)(t,o.options)&&Object(h.g)(r,o.config))return o;throw I.create("duplicate-app",{appName:i})}var s,u=new c.b(i),l=Object(a.a)(b.values());try{for(l.s();!(s=l.n()).done;){var f=s.value;u.addComponent(f)}}catch(p){l.e(p)}finally{l.f()}var d=new S(t,r,u);return m.set(i,d),d}function C(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=m.get(t);if(!e)throw I.create("no-app",{appName:t});return e}function _(t,e,n){var r,i=null!==(r=g[t])&&void 0!==r?r:t;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(e,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void v.warn(s.join(" "))}w(new c.a("".concat(i,"-version"),(function(){return{library:i,version:e}}),"VERSION"))}j="",w(new c.a("platform-logger",(function(t){return new f(t)}),"PRIVATE")),_(d,p,j),_(d,p,"esm2017"),_("fire-js","")},557:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return f}));function r(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}Object.create;function a(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function s(t,e,n){if(n||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create;var u=n(550),c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),l="[DEFAULT]",h=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new u.a;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:l})}catch(d){}try{for(var r=a(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=o(i.value,2),u=s[0],c=s[1],h=this.normalizeInstanceIdentifier(u);try{var f=this.getOrInitializeService({instanceIdentifier:h});c.resolve(f)}catch(d){}}}catch(p){e={error:p}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=l),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],o(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),o(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=l),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=l),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:s,options:i});try{for(var c=a(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var h=o(l.value,2),f=h[0],d=h[1];s===this.normalizeInstanceIdentifier(f)&&d.resolve(u)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return u},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&t(a,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=a(i),s=o.next();!s.done;s=o.next()){var u=s.value;try{u(t,e)}catch(c){}}}catch(l){n={error:l}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===l?void 0:e),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=l),this.component?this.component.multipleInstances?t:l:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();var f=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new h(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},561:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(573);var i=n(566);function a(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(i.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},562:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(120);function i(t,e,n){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(r.a)(t)););return t}(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}},i(t,e,n||t)}},566:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(573);function i(t,e){if(t){if("string"===typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},567:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return v})),n.d(e,"d",(function(){return y}));var r,i,a=n(549),o=n(172),s=n(173),u=n(179),c=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));var l={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},h=i.INFO,f=(r={},Object(u.a)(r,i.DEBUG,"log"),Object(u.a)(r,i.VERBOSE,"log"),Object(u.a)(r,i.INFO,"info"),Object(u.a)(r,i.WARN,"warn"),Object(u.a)(r,i.ERROR,"error"),r),d=function(t,e){if(!(e<t.logLevel)){var n=(new Date).toISOString(),r=f[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(t.name,":")].concat(o))}},p=function(){function t(e){Object(o.a)(this,t),this.name=e,this._logLevel=h,this._logHandler=d,this._userLogHandler=null,c.push(this)}return Object(s.a)(t,[{key:"logLevel",get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}},{key:"setLogLevel",value:function(t){this._logLevel="string"===typeof t?l[t]:t}},{key:"logHandler",get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.DEBUG].concat(e)),this._logHandler.apply(this,[this,i.DEBUG].concat(e))}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.VERBOSE].concat(e)),this._logHandler.apply(this,[this,i.VERBOSE].concat(e))}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.INFO].concat(e)),this._logHandler.apply(this,[this,i.INFO].concat(e))}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.WARN].concat(e)),this._logHandler.apply(this,[this,i.WARN].concat(e))}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,i.ERROR].concat(e)),this._logHandler.apply(this,[this,i.ERROR].concat(e))}}]),t}();function v(t){c.forEach((function(e){e.setLogLevel(t)}))}function y(t,e){var n,r=Object(a.a)(c);try{var o=function(){var r=n.value,a=null;e&&e.level&&(a=l[e.level]),r.userLogHandler=null===t?null:function(e,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];var u=o.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==a&&void 0!==a?a:e.logLevel)&&t({level:i[n].toLowerCase(),message:u,args:o,type:e.name})}};for(r.s();!(n=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}}},573:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},574:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return Do})),n.d(e,"b",(function(){return ws})),n.d(e,"c",(function(){return Lo})),n.d(e,"d",(function(){return gs})),n.d(e,"e",(function(){return bs})),n.d(e,"f",(function(){return Po})),n.d(e,"g",(function(){return ks}));var r=n(575),i=n(562),a=n(120),o=n(547),s=n(549),u=n(542),c=n.n(u),l=n(543),h=n(174),f=n(175),d=n(587),p=n(561),v=n(172),y=n(173),g=n(551),m=n(557),b=n(567),k=n(550),w=n(600),O="@firebase/firestore",E=function(){function t(e){Object(v.a)(this,t),this.uid=e}return Object(y.a)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(t){return t.uid===this.uid}}]),t}();E.UNAUTHENTICATED=new E(null),E.GOOGLE_CREDENTIALS=new E("google-credentials-uid"),E.FIRST_PARTY=new E("first-party-uid"),E.MOCK_USER=new E("mock-user");var j="9.1.3",T=new b.b("@firebase/firestore");function I(){return T.logLevel}function S(t){if(T.logLevel<=b.a.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(C);T.debug.apply(T,["Firestore (".concat(j,"): ").concat(t)].concat(Object(p.a)(i)))}}function x(t){if(T.logLevel<=b.a.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(C);T.error.apply(T,["Firestore (".concat(j,"): ").concat(t)].concat(Object(p.a)(i)))}}function A(t){if(T.logLevel<=b.a.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(C);T.warn.apply(T,["Firestore (".concat(j,"): ").concat(t)].concat(Object(p.a)(i)))}}function C(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",e="FIRESTORE (".concat(j,") INTERNAL ASSERTION FAILED: ")+t;throw x(e),new Error(e)}function N(t,e){t||_()}function D(t,e){return t}var L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},R=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,r)).code=t,i.message=r,i.name="FirebaseError",i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return n}(Object(d.a)(Error)),M=function t(){var e=this;Object(v.a)(this,t),this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},P=function t(e,n){Object(v.a)(this,t),this.user=n,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer ".concat(e)},V=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(E.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),F=function(){function t(e){Object(v.a)(this,t),this.t=e,this.currentUser=E.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Object(y.a)(t,[{key:"start",value:function(t,e){var n=this,r=this.i,i=function(t){return n.i!==r?(r=n.i,e(t)):Promise.resolve()},a=new M;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new M,t.enqueueRetryable((function(){return i(n.currentUser)}))};var o=function(){var e=a;t.enqueueRetryable(Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.promise;case 2:return t.next=4,i(n.currentUser);case 4:case"end":return t.stop()}}),t)}))))},s=function(t){S("FirebaseCredentialsProvider","Auth detected"),n.auth=t,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(t){return s(t)})),setTimeout((function(){if(!n.auth){var t=n.t.getImmediate({optional:!0});t?s(t):(S("FirebaseCredentialsProvider","Auth not yet detected"),a.resolve(),a=new M)}}),0),o()}},{key:"getToken",value:function(){var t=this,e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.i!==e?(S("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(N("string"==typeof n.accessToken),new P(n.accessToken,t.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var t=this.auth&&this.auth.getUid();return N(null===t||"string"==typeof t),new E(t)}}]),t}(),U=function(){function t(e,n,r){Object(v.a)(this,t),this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=E.FIRST_PARTY}return Object(y.a)(t,[{key:"authHeaders",get:function(){var t={"X-Goog-AuthUser":this.l},e=this.h.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.m&&(t["X-Goog-Iam-Authorization-Token"]=this.m),t}}]),t}(),B=function(){function t(e,n,r){Object(v.a)(this,t),this.h=e,this.l=n,this.m=r}return Object(y.a)(t,[{key:"getToken",value:function(){return Promise.resolve(new U(this.h,this.l,this.m))}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(E.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),q=function(){function t(e,n){var r=this;Object(v.a)(this,t),this.previousValue=e,n&&(n.sequenceNumberHandler=function(t){return r.g(t)},this.p=function(t){return n.writeSequenceNumber(t)})}return Object(y.a)(t,[{key:"g",value:function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}},{key:"next",value:function(){var t=++this.previousValue;return this.p&&this.p(t),t}}]),t}();function H(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}q.T=-1;var K=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,null,[{key:"I",value:function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=H(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n}}]),t}();function z(t,e){return t<e?-1:t>e?1:0}function G(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}var W=function(){function t(e,n){if(Object(v.a)(this,t),this.seconds=e,this.nanoseconds=n,n<0)throw new R(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new R(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new R(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new R(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return Object(y.a)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(t){return this.seconds===t.seconds?z(this.nanoseconds,t.nanoseconds):z(this.seconds,t.seconds)}},{key:"isEqual",value:function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),Q=function(){function t(e){Object(v.a)(this,t),this.timestamp=e}return Object(y.a)(t,[{key:"compareTo",value:function(t){return this.timestamp._compareTo(t.timestamp)}},{key:"isEqual",value:function(t){return this.timestamp.isEqual(t.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new W(0,0))}}]),t}();function X(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Y(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function J(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $=function(){function t(e,n,r){Object(v.a)(this,t),void 0===n?n=0:n>e.length&&_(),void 0===r?r=e.length-n:r>e.length-n&&_(),this.segments=e,this.offset=n,this.len=r}return Object(y.a)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(t){return this.segments[this.offset+t]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"isImmediateParentOf",value:function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"forEach",value:function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),a=e.get(r);if(i<a)return-1;if(i>a)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}]),t}(),Z=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"construct",value:function(t,e,r){return new n(t,e,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=[],e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new R(L.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));t.push.apply(t,Object(p.a)(s.split("/").filter((function(t){return t.length>0}))))}return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($),tt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,et=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"construct",value:function(t,e,r){return new n(t,e,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(t){return tt.test(t)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(t){for(var e=[],r="",i=0,a=function(){if(0===r.length)throw new R(L.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(r),r=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new R(L.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new R(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new R(L.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($),nt=function(){function t(e){Object(v.a)(this,t),this.fields=e,e.sort(et.comparator)}return Object(y.a)(t,[{key:"covers",value:function(t){var e,n=Object(s.a)(this.fields);try{for(n.s();!(e=n.n()).done;){if(e.value.isPrefixOf(t))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(t){return G(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))}}]),t}();var rt=function(){function t(e){Object(v.a)(this,t),this.binaryString=e}return Object(y.a)(t,[{key:"toBase64",value:function(){return t=this.binaryString,btoa(t);var t}},{key:"toUint8Array",value:function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(t){return z(this.binaryString,t.binaryString)}},{key:"isEqual",value:function(t){return this.binaryString===t.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e);return new t(n)}}]),t}();rt.EMPTY_BYTE_STRING=new rt("");var it=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function at(t){if(N(!!t),"string"==typeof t){var e=0,n=it.exec(t);if(N(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function st(t){return"string"==typeof t?rt.fromBase64String(t):rt.fromUint8Array(t)}function ut(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ct(t){var e=t.mapValue.fields.__previous_value__;return ut(e)?ct(e):e}function lt(t){var e=at(t.mapValue.fields.__local_write_time__.timestampValue);return new W(e.seconds,e.nanos)}function ht(t){return null==t}function ft(t){return 0===t&&1/t==-1/0}function dt(t){return"number"==typeof t&&Number.isInteger(t)&&!ft(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var pt=function(){function t(e){Object(v.a)(this,t),this.path=e}return Object(y.a)(t,[{key:"hasCollectionId",value:function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}},{key:"isEqual",value:function(t){return null!==t&&0===Z.comparator(this.path,t.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(Z.fromString(e))}},{key:"fromName",value:function(e){return new t(Z.fromString(e).popFirst(5))}},{key:"comparator",value:function(t,e){return Z.comparator(t.path,e.path)}},{key:"isDocumentKey",value:function(t){return t.length%2==0}},{key:"fromSegments",value:function(e){return new t(new Z(e.slice()))}}]),t}();function vt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ut(t)?4:10:_()}function yt(t,e){var n=vt(t);if(n!==vt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return lt(t).isEqual(lt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=at(t.timestampValue),r=at(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return st(t.bytesValue).isEqual(st(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ot(t.geoPointValue.latitude)===ot(e.geoPointValue.latitude)&&ot(t.geoPointValue.longitude)===ot(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ot(t.integerValue)===ot(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ot(t.doubleValue),r=ot(e.doubleValue);return n===r?ft(n)===ft(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return G(t.arrayValue.values||[],e.arrayValue.values||[],yt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(X(n)!==X(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!yt(n[i],r[i])))return!1;return!0}(t,e);default:return _()}}function gt(t,e){return void 0!==(t.values||[]).find((function(t){return yt(t,e)}))}function mt(t,e){var n=vt(t),r=vt(e);if(n!==r)return z(n,r);switch(n){case 0:return 0;case 1:return z(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ot(t.integerValue||t.doubleValue),r=ot(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return bt(t.timestampValue,e.timestampValue);case 4:return bt(lt(t),lt(e));case 5:return z(t.stringValue,e.stringValue);case 6:return function(t,e){var n=st(t),r=st(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var a=z(n[i],r[i]);if(0!==a)return a}return z(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=z(ot(t.latitude),ot(e.latitude));return 0!==n?n:z(ot(t.longitude),ot(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var a=mt(n[i],r[i]);if(a)return a}return z(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=z(r[o],a[o]);if(0!==s)return s;var u=mt(n[r[o]],i[a[o]]);if(0!==u)return u}return z(r.length,a.length)}(t.mapValue,e.mapValue);default:throw _()}}function bt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return z(t,e);var n=at(t),r=at(e),i=z(n.seconds,r.seconds);return 0!==i?i:z(n.nanos,r.nanos)}function kt(t){return wt(t)}function wt(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=at(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?st(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,pt.fromName(n).toString()):"geoPointValue"in t?"geo(".concat((e=t.geoPointValue).latitude,",").concat(e.longitude,")"):"arrayValue"in t?function(t){var e,n="[",r=!0,i=Object(s.a)(t.values||[]);try{for(i.s();!(e=i.n()).done;){var a=e.value;r?r=!1:n+=",",n+=wt(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(t.arrayValue):"mapValue"in t?function(t){var e,n=Object.keys(t.fields||{}).sort(),r="{",i=!0,a=Object(s.a)(n);try{for(a.s();!(e=a.n()).done;){var o=e.value;i?i=!1:r+=",",r+="".concat(o,":").concat(wt(t.fields[o]))}}catch(u){a.e(u)}finally{a.f()}return r+"}"}(t.mapValue):_();var e,n}function Ot(t){return!!t&&"integerValue"in t}function Et(t){return!!t&&"arrayValue"in t}function jt(t){return!!t&&"nullValue"in t}function Tt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function It(t){return!!t&&"mapValue"in t}function St(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Y(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=St(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=St(t.arrayValue.values[r]);return n}return Object.assign({},t)}var xt=function(){function t(e){Object(v.a)(this,t),this.value=e}return Object(y.a)(t,[{key:"field",value:function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!It(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null}},{key:"set",value:function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=St(e)}},{key:"setAll",value:function(t){var e=this,n=et.emptyPath(),r={},i=[];t.forEach((function(t,a){if(!n.isImmediateParentOf(a)){var o=e.getFieldsMap(n);e.applyChanges(o,r,i),r={},i=[],n=a.popLast()}t?r[a.lastSegment()]=St(t):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(t){var e=this.field(t.popLast());It(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}},{key:"isEqual",value:function(t){return yt(this.value,t.value)}},{key:"getFieldsMap",value:function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];It(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}},{key:"applyChanges",value:function(t,e,n){Y(e,(function(e,n){return t[e]=n}));var r,i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete t[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new t(St(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();function At(t){var e=[];return Y(t.fields,(function(t,n){var r=new et([t]);if(It(n)){var i=At(n.mapValue).fields;if(0===i.length)e.push(r);else{var a,o=Object(s.a)(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;e.push(r.child(u))}}catch(c){o.e(c)}finally{o.f()}}}else e.push(r)})),new nt(e)}var Ct=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.key=e,this.documentType=n,this.version=r,this.data=i,this.documentState=a}return Object(y.a)(t,[{key:"convertToFoundDocument",value:function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}},{key:"convertToNoDocument",value:function(t){return this.version=t,this.documentType=2,this.data=xt.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(t){return this.version=t,this.documentType=3,this.data=xt.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"clone",value:function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,Q.min(),xt.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r){return new t(e,1,n,r,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,xt.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,xt.empty(),2)}}]),t}(),_t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Object(v.a)(this,t),this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.A=null};function Nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new _t(t,e,n,r,i,a,o)}function Dt(t){var e=D(t);if(null===e.A){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+kt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ht(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Gt(e.startAt)),e.endAt&&(n+="|ub:",n+=Gt(e.endAt)),e.A=n}return e.A}function Lt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Qt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],a=e.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!yt(i.value,a.value))return!1;var i,a;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Yt(t.startAt,e.startAt)&&Yt(t.endAt,e.endAt)}function Rt(t){return pt.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Mt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).field=t,a.op=r,a.value=i,a}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.P(mt(e,this.value)):null!==e&&vt(this.value)===vt(e)&&this.P(mt(e,this.value))}},{key:"P",value:function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return _()}}},{key:"v",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.R(t,e,r):new Pt(t,e,r):"array-contains"===e?new Bt(t,r):"in"===e?new qt(t,r):"not-in"===e?new Ht(t,r):"array-contains-any"===e?new Kt(t,r):new n(t,e,r)}},{key:"R",value:function(t,e,n){return"in"===e?new Vt(t,n):new Ft(t,n)}}]),n}(function(){return function t(){Object(v.a)(this,t)}}());var Pt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this,t,r,i)).key=pt.fromName(i.referenceValue),a}return Object(y.a)(n,[{key:"matches",value:function(t){var e=pt.comparator(t.key,this.key);return this.P(e)}}]),n}(Mt),Vt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,"in",r)).keys=Ut("in",r),i}return Object(y.a)(n,[{key:"matches",value:function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))}}]),n}(Mt),Ft=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,"not-in",r)).keys=Ut("not-in",r),i}return Object(y.a)(n,[{key:"matches",value:function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))}}]),n}(Mt);function Ut(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return pt.fromName(t.referenceValue)}))}var Bt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"array-contains",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return Et(e)&&gt(e.arrayValue,this.value)}}]),n}(Mt),qt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"in",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return null!==e&&gt(this.value.arrayValue,e)}}]),n}(Mt),Ht=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"not-in",r)}return Object(y.a)(n,[{key:"matches",value:function(t){if(gt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!gt(this.value.arrayValue,e)}}]),n}(Mt),Kt=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"array-contains-any",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=this,n=t.data.field(this.field);return!(!Et(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return gt(e.value.arrayValue,t)}))}}]),n}(Mt),zt=function t(e,n){Object(v.a)(this,t),this.position=e,this.before=n};function Gt(t){return"".concat(t.before?"b":"a",":").concat(t.position.map((function(t){return kt(t)})).join(","))}var Wt=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";Object(v.a)(this,t),this.field=e,this.dir=n};function Qt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Xt(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var a=e[i],o=t.position[i];if(r=a.field.isKeyField()?pt.comparator(pt.fromName(o.referenceValue),n.key):mt(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Yt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yt(t.position[n],e.position[n]))return!1;return!0}var Jt=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Object(v.a)(this,t),this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.V=null,this.S=null,this.startAt,this.endAt};function $t(t,e,n,r,i,a,o,s){return new Jt(t,e,n,r,i,a,o,s)}function Zt(t){return new Jt(t)}function te(t){return!ht(t.limit)&&"F"===t.limitType}function ee(t){return!ht(t.limit)&&"L"===t.limitType}function ne(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function re(t){var e,n=Object(s.a)(t.filters);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.v())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function ie(t){return null!==t.collectionGroup}function ae(t){var e=D(t);if(null===e.V){e.V=[];var n=re(e),r=ne(e);if(null!==n&&null===r)n.isKeyField()||e.V.push(new Wt(n)),e.V.push(new Wt(et.keyField(),"asc"));else{var i,a=!1,o=Object(s.a)(e.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;e.V.push(u),u.field.isKeyField()&&(a=!0)}}catch(l){o.e(l)}finally{o.f()}if(!a){var c=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new Wt(et.keyField(),c))}}}return e.V}function oe(t){var e=D(t);if(!e.S)if("F"===e.limitType)e.S=Nt(e.path,e.collectionGroup,ae(e),e.filters,e.limit,e.startAt,e.endAt);else{var n,r=[],i=Object(s.a)(ae(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new Wt(a.field,o))}}catch(l){i.e(l)}finally{i.f()}var u=e.endAt?new zt(e.endAt.position,!e.endAt.before):null,c=e.startAt?new zt(e.startAt.position,!e.startAt.before):null;e.S=Nt(e.path,e.collectionGroup,r,e.filters,e.limit,u,c)}return e.S}function se(t,e,n){return new Jt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ue(t,e){return Lt(oe(t),oe(e))&&t.limitType===e.limitType}function ce(t){return"".concat(Dt(oe(t)),"|lt:").concat(t.limitType)}function le(t){return"Query(target=".concat(function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map((function(t){return"".concat((e=t).field.canonicalString()," ").concat(e.op," ").concat(kt(e.value));var e})).join(", "),"]")),ht(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map((function(t){return function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t)})).join(", "),"]")),t.startAt&&(e+=", startAt: "+Gt(t.startAt)),t.endAt&&(e+=", endAt: "+Gt(t.endAt)),"Target(".concat(e,")")}(oe(t)),"; limitType=").concat(t.limitType,")")}function he(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):pt.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){var n,r=Object(s.a)(t.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(t,e)&&function(t,e){var n,r=Object(s.a)(t.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(e))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(t,e)&&function(t,e){return!(t.startAt&&!Xt(t.startAt,ae(t),e))&&(!t.endAt||!Xt(t.endAt,ae(t),e))}(t,e)}function fe(t){return function(e,n){var r,i=!1,a=Object(s.a)(ae(t));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=de(o,e,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(c){a.e(c)}finally{a.f()}return 0}}function de(t,e,n){var r=t.field.isKeyField()?pt.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?mt(r,i):_()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _()}}function pe(t,e){if(t.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ft(e)?"-0":e}}function ve(t){return{integerValue:""+t}}function ye(t,e){return dt(e)?ve(e):pe(t,e)}var ge=function t(){Object(v.a)(this,t),this._=void 0};function me(t,e,n){return t instanceof we?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Oe?Ee(t,e):t instanceof je?Te(t,e):function(t,e){var n=ke(t,e),r=Se(n)+Se(t.C);return Ot(n)&&Ot(t.C)?ve(r):pe(t.N,r)}(t,e)}function be(t,e,n){return t instanceof Oe?Ee(t,e):t instanceof je?Te(t,e):n}function ke(t,e){return t instanceof Ie?Ot(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var we=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return n}(ge),Oe=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).elements=t,r}return n}(ge);function Ee(t,e){var n,r=xe(e),i=Object(s.a)(t.elements);try{var a=function(){var t=n.value;r.some((function(e){return yt(e,t)}))||r.push(t)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var je=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).elements=t,r}return n}(ge);function Te(t,e){var n,r=xe(e),i=Object(s.a)(t.elements);try{var a=function(){var t=n.value;r=r.filter((function(e){return!yt(e,t)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Ie=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).N=t,i.C=r,i}return n}(ge);function Se(t){return ot(t.integerValue||t.doubleValue)}function xe(t){return Et(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ae=function t(e,n){Object(v.a)(this,t),this.version=e,this.transformResults=n},Ce=function(){function t(e,n){Object(v.a)(this,t),this.updateTime=e,this.exists=n}return Object(y.a)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function _e(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ne=function t(){Object(v.a)(this,t)};function De(t,e,n){t instanceof Ve?function(t,e,n){var r=t.value.clone(),i=Be(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Fe?function(t,e,n){if(_e(t.precondition,e)){var r=Be(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Ue(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Le(t,e,n){t instanceof Ve?function(t,e,n){if(_e(t.precondition,e)){var r=t.value.clone(),i=qe(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Pe(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Fe?function(t,e,n){if(_e(t.precondition,e)){var r=qe(t.fieldTransforms,n,e),i=e.data;i.setAll(Ue(t)),i.setAll(r),e.convertToFoundDocument(Pe(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){_e(t.precondition,e)&&e.convertToNoDocument(Q.min())}(t,e)}function Re(t,e){var n,r=null,i=Object(s.a)(t.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.data.field(a.field),u=ke(a.transform,o||null);null!=u&&(null==r&&(r=xt.empty()),r.set(a.field,u))}}catch(c){i.e(c)}finally{i.f()}return r||null}function Me(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&G(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Oe&&e instanceof Oe||t instanceof je&&e instanceof je?G(t.elements,e.elements,yt):t instanceof Ie&&e instanceof Ie?yt(t.C,e.C):t instanceof we&&e instanceof we}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Pe(t){return t.isFoundDocument()?t.version:Q.min()}var Ve=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Object(v.a)(this,n),(a=e.call(this)).key=t,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return n}(Ne),Fe=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Object(v.a)(this,n),(o=e.call(this)).key=t,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return n}(Ne);function Ue(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Be(t,e,n){var r=new Map;N(t.length===n.length);for(var i=0;i<n.length;i++){var a=t[i],o=a.transform,s=e.data.field(a.field);r.set(a.field,be(o,s,n[i]))}return r}function qe(t,e,n){var r,i=new Map,a=Object(s.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,c=n.data.field(o.field);i.set(o.field,me(u,c,e))}}catch(l){a.e(l)}finally{a.f()}return i}var He,Ke,ze=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).key=t,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return n}(Ne),Ge=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).key=t,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return n}(Ne),We=function t(e){Object(v.a)(this,t),this.count=e};function Qe(t){switch(t){default:return _();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function Xe(t){if(void 0===t)return x("GRPC error has no .code"),L.UNKNOWN;switch(t){case He.OK:return L.OK;case He.CANCELLED:return L.CANCELLED;case He.UNKNOWN:return L.UNKNOWN;case He.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case He.INTERNAL:return L.INTERNAL;case He.UNAVAILABLE:return L.UNAVAILABLE;case He.UNAUTHENTICATED:return L.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case He.NOT_FOUND:return L.NOT_FOUND;case He.ALREADY_EXISTS:return L.ALREADY_EXISTS;case He.PERMISSION_DENIED:return L.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case He.ABORTED:return L.ABORTED;case He.OUT_OF_RANGE:return L.OUT_OF_RANGE;case He.UNIMPLEMENTED:return L.UNIMPLEMENTED;case He.DATA_LOSS:return L.DATA_LOSS;default:return _()}}(Ke=He||(He={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";var Ye=function(){function t(e,n){Object(v.a)(this,t),this.comparator=e,this.root=n||$e.EMPTY}return Object(y.a)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$e.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$e.BLACK,null,null))}},{key:"get",value:function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}},{key:"indexOf",value:function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(t){return this.root.inorderTraversal(t)}},{key:"forEach",value:function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))}},{key:"toString",value:function(){var t=[];return this.inorderTraversal((function(e,n){return t.push("".concat(e,":").concat(n)),!1})),"{".concat(t.join(", "),"}")}},{key:"reverseTraversal",value:function(t){return this.root.reverseTraversal(t)}},{key:"getIterator",value:function(){return new Je(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(t){return new Je(this.root,t,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Je(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(t){return new Je(this.root,t,this.comparator,!0)}}]),t}(),Je=function(){function t(e,n,r,i){Object(v.a)(this,t),this.isReverse=i,this.nodeStack=[];for(var a=1;!e.isEmpty();)if(a=n?r(e.key,n):1,i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return Object(y.a)(t,[{key:"getNext",value:function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}]),t}(),$e=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=a?a:t.EMPTY,this.size=this.left.size+1+this.right.size}return Object(y.a)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}},{key:"reverseTraversal",value:function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}},{key:"moveRedLeft",value:function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t}},{key:"moveRedRight",value:function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}},{key:"checkMaxDepth",value:function(){var t=this.check();return Math.pow(2,t)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw _();if(this.right.isRed())throw _();var t=this.left.check();if(t!==this.right.check())throw _();return t+(this.isRed()?0:1)}}]),t}();$e.EMPTY=null,$e.RED=!0,$e.BLACK=!1,$e.EMPTY=new(function(){function t(){Object(v.a)(this,t),this.size=0}return Object(y.a)(t,[{key:"key",get:function(){throw _()}},{key:"value",get:function(){throw _()}},{key:"color",get:function(){throw _()}},{key:"left",get:function(){throw _()}},{key:"right",get:function(){throw _()}},{key:"copy",value:function(t,e,n,r,i){return this}},{key:"insert",value:function(t,e,n){return new $e(t,e)}},{key:"remove",value:function(t,e){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(t){return!1}},{key:"reverseTraversal",value:function(t){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());var Ze=function(){function t(e){Object(v.a)(this,t),this.comparator=e,this.data=new Ye(this.comparator)}return Object(y.a)(t,[{key:"has",value:function(t){return null!==this.data.get(t)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(t){return this.data.indexOf(t)}},{key:"forEach",value:function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"forEachInRange",value:function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}},{key:"forEachWhile",value:function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}},{key:"getIterator",value:function(){return new tn(this.data.getIterator())}},{key:"getIteratorFrom",value:function(t){return new tn(this.data.getIteratorFrom(t))}},{key:"add",value:function(t){return this.copy(this.data.remove(t).insert(t,!0))}},{key:"delete",value:function(t){return this.has(t)?this.copy(this.data.remove(t)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var t=[];return this.forEach((function(e){t.push(e)})),t}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),tn=function(){function t(e){Object(v.a)(this,t),this.iter=e}return Object(y.a)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}(),en=new Ye(pt.comparator);function nn(){return en}var rn=new Ye(pt.comparator);function an(){return rn}var on=new Ye(pt.comparator);function sn(){return on}var un=new Ze(pt.comparator);function cn(){for(var t=un,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];t=t.add(o)}return t}var ln=new Ze(z);function hn(){return ln}var fn=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return Object(y.a)(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n){var r=new Map;return r.set(e,dn.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Q.min(),r,hn(),nn(),cn())}}]),t}(),dn=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return Object(y.a)(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n){return new t(rt.EMPTY_BYTE_STRING,n,cn(),cn(),cn())}}]),t}(),pn=function t(e,n,r,i){Object(v.a)(this,t),this.k=e,this.removedTargetIds=n,this.key=r,this.$=i},vn=function t(e,n){Object(v.a)(this,t),this.targetId=e,this.O=n},yn=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(v.a)(this,t),this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i},gn=function(){function t(){Object(v.a)(this,t),this.F=0,this.M=kn(),this.L=rt.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}return Object(y.a)(t,[{key:"current",get:function(){return this.B}},{key:"resumeToken",get:function(){return this.L}},{key:"q",get:function(){return 0!==this.F}},{key:"K",get:function(){return this.U}},{key:"j",value:function(t){t.approximateByteSize()>0&&(this.U=!0,this.L=t)}},{key:"W",value:function(){var t=cn(),e=cn(),n=cn();return this.M.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:_()}})),new dn(this.L,this.B,t,e,n)}},{key:"G",value:function(){this.U=!1,this.M=kn()}},{key:"H",value:function(t,e){this.U=!0,this.M=this.M.insert(t,e)}},{key:"J",value:function(t){this.U=!0,this.M=this.M.remove(t)}},{key:"Y",value:function(){this.F+=1}},{key:"X",value:function(){this.F-=1}},{key:"Z",value:function(){this.U=!0,this.B=!0}}]),t}(),mn=function(){function t(e){Object(v.a)(this,t),this.tt=e,this.et=new Map,this.nt=nn(),this.st=bn(),this.it=new Ze(z)}return Object(y.a)(t,[{key:"rt",value:function(t){var e,n=Object(s.a)(t.k);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.$&&t.$.isFoundDocument()?this.ot(r,t.$):this.at(r,t.key,t.$)}}catch(u){n.e(u)}finally{n.f()}var i,a=Object(s.a)(t.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.at(o,t.key,t.$)}}catch(u){a.e(u)}finally{a.f()}}},{key:"ct",value:function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ut(n);switch(t.state){case 0:e.ht(n)&&r.j(t.resumeToken);break;case 1:r.X(),r.q||r.G(),r.j(t.resumeToken);break;case 2:r.X(),r.q||e.removeTarget(n);break;case 3:e.ht(n)&&(r.Z(),r.j(t.resumeToken));break;case 4:e.ht(n)&&(e.lt(n),r.j(t.resumeToken));break;default:_()}}))}},{key:"forEachTarget",value:function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.et.forEach((function(t,r){n.ht(r)&&e(r)}))}},{key:"ft",value:function(t){var e=t.targetId,n=t.O.count,r=this.dt(e);if(r){var i=r.target;if(Rt(i))if(0===n){var a=new pt(i.path);this.at(e,a,Ct.newNoDocument(a,Q.min()))}else N(1===n);else this.wt(e)!==n&&(this.lt(e),this.it=this.it.add(e))}}},{key:"_t",value:function(t){var e=this,n=new Map;this.et.forEach((function(r,i){var a=e.dt(i);if(a){if(r.current&&Rt(a.target)){var o=new pt(a.target.path);null!==e.nt.get(o)||e.gt(i,o)||e.at(i,o,Ct.newNoDocument(o,t))}r.K&&(n.set(i,r.W()),r.G())}}));var r=cn();this.st.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.dt(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new fn(t,n,this.it,this.nt,r);return this.nt=nn(),this.st=bn(),this.it=new Ze(z),i}},{key:"ot",value:function(t,e){if(this.ht(t)){var n=this.gt(t,e.key)?2:0;this.ut(t).H(e.key,n),this.nt=this.nt.insert(e.key,e),this.st=this.st.insert(e.key,this.yt(e.key).add(t))}}},{key:"at",value:function(t,e,n){if(this.ht(t)){var r=this.ut(t);this.gt(t,e)?r.H(e,1):r.J(e),this.st=this.st.insert(e,this.yt(e).delete(t)),n&&(this.nt=this.nt.insert(e,n))}}},{key:"removeTarget",value:function(t){this.et.delete(t)}},{key:"wt",value:function(t){var e=this.ut(t).W();return this.tt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}},{key:"Y",value:function(t){this.ut(t).Y()}},{key:"ut",value:function(t){var e=this.et.get(t);return e||(e=new gn,this.et.set(t,e)),e}},{key:"yt",value:function(t){var e=this.st.get(t);return e||(e=new Ze(z),this.st=this.st.insert(t,e)),e}},{key:"ht",value:function(t){var e=null!==this.dt(t);return e||S("WatchChangeAggregator","Detected inactive target",t),e}},{key:"dt",value:function(t){var e=this.et.get(t);return e&&e.q?null:this.tt.Tt(t)}},{key:"lt",value:function(t){var e=this;this.et.set(t,new gn),this.tt.getRemoteKeysForTarget(t).forEach((function(n){e.at(t,n,null)}))}},{key:"gt",value:function(t,e){return this.tt.getRemoteKeysForTarget(t).has(e)}}]),t}();function bn(){return new Ye(pt.comparator)}function kn(){return new Ye(pt.comparator)}var wn={asc:"ASCENDING",desc:"DESCENDING"},On={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},En=function t(e,n){Object(v.a)(this,t),this.databaseId=e,this.D=n};function jn(t,e){return t.D?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tn(t,e){return t.D?e.toBase64():e.toUint8Array()}function In(t,e){return jn(t,e.toTimestamp())}function Sn(t){return N(!!t),Q.fromTimestamp(function(t){var e=at(t);return new W(e.seconds,e.nanos)}(t))}function xn(t,e){return function(t){return new Z(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function An(t){var e=Z.fromString(t);return N(Jn(e)),e}function Cn(t,e){return xn(t.databaseId,e.path)}function _n(t,e){var n=An(e);if(n.get(1)!==t.databaseId.projectId)throw new R(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new R(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new pt(Rn(n))}function Nn(t,e){return xn(t.databaseId,e)}function Dn(t){var e=An(t);return 4===e.length?Z.emptyPath():Rn(e)}function Ln(t){return new Z(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Rn(t){return N(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Mn(t,e,n){return{name:Cn(t,e),fields:n.value.mapValue.fields}}function Pn(t,e){var n;if(e instanceof Ve)n={update:Mn(t,e.key,e.value)};else if(e instanceof ze)n={delete:Cn(t,e.key)};else if(e instanceof Fe)n={update:Mn(t,e.key,e.data),updateMask:Yn(e.fieldMask)};else{if(!(e instanceof Ge))return _();n={verify:Cn(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof we)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Oe)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof je)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ie)return{fieldPath:e.field.canonicalString(),increment:n.C};throw _()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:In(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:_()}(t,e.precondition)),n}function Vn(t,e){return{documents:[Nn(t,e.path)]}}function Fn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Nn(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Nn(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Tt(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NAN"}};if(jt(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Tt(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NOT_NAN"}};if(jt(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gn(t.field),op:zn(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var a=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Gn(t.field),direction:Kn(t.dir)}}(t)}))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);var o=function(t,e){return t.D||ht(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=qn(e.startAt)),e.endAt&&(n.structuredQuery.endAt=qn(e.endAt)),n}function Un(t){var e=Dn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){N(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:e=e.child(a.collectionId)}var o=[];n.where&&(o=Bn(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Wt(Wn(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ht(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Hn(n.startAt));var l=null;return n.endAt&&(l=Hn(n.endAt)),$t(e,i,s,o,u,"F",c,l)}function Bn(t){return t?void 0!==t.unaryFilter?[Xn(t)]:void 0!==t.fieldFilter?[Qn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Bn(t)})).reduce((function(t,e){return t.concat(e)})):_():[]}function qn(t){return{before:t.before,values:t.position}}function Hn(t){var e=!!t.before,n=t.values||[];return new zt(n,e)}function Kn(t){return wn[t]}function zn(t){return On[t]}function Gn(t){return{fieldPath:t.canonicalString()}}function Wn(t){return et.fromServerFormat(t.fieldPath)}function Qn(t){return Mt.create(Wn(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _()}}(t.fieldFilter.op),t.fieldFilter.value)}function Xn(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Wn(t.unaryFilter.field);return Mt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Wn(t.unaryFilter.field);return Mt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Wn(t.unaryFilter.field);return Mt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Wn(t.unaryFilter.field);return Mt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return _()}}function Yn(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Jn(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function $n(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=tr(e)),e=Zn(t.get(n),e);return tr(e)}function Zn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var a=t.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function tr(t){return t+"\x01\x01"}var er=function t(e,n,r){Object(v.a)(this,t),this.ownerId=e,this.allowTabSynchronization=n,this.leaseTimestampMs=r};er.store="owner",er.key="owner";var nr=function t(e,n,r){Object(v.a)(this,t),this.userId=e,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r};nr.store="mutationQueues",nr.keyPath="userId";var rr=function t(e,n,r,i,a){Object(v.a)(this,t),this.userId=e,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=a};rr.store="mutations",rr.keyPath="batchId",rr.userMutationsIndex="userMutationsIndex",rr.userMutationsKeyPath=["userId","batchId"];var ir=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,null,[{key:"prefixForUser",value:function(t){return[t]}},{key:"prefixForPath",value:function(t,e){return[t,$n(e)]}},{key:"key",value:function(t,e,n){return[t,$n(e),n]}}]),t}();ir.store="documentMutations",ir.PLACEHOLDER=new ir;var ar=function t(e,n,r,i,a,o){Object(v.a)(this,t),this.unknownDocument=e,this.noDocument=n,this.document=r,this.hasCommittedMutations=i,this.readTime=a,this.parentPath=o};ar.store="remoteDocuments",ar.readTimeIndex="readTimeIndex",ar.readTimeIndexPath="readTime",ar.collectionReadTimeIndex="collectionReadTimeIndex",ar.collectionReadTimeIndexPath=["parentPath","readTime"];var or=function t(e){Object(v.a)(this,t),this.byteSize=e};or.store="remoteDocumentGlobal",or.key="remoteDocumentGlobalKey";var sr=function t(e,n,r,i,a,o,s){Object(v.a)(this,t),this.targetId=e,this.canonicalId=n,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=a,this.lastLimboFreeSnapshotVersion=o,this.query=s};sr.store="targets",sr.keyPath="targetId",sr.queryTargetsIndexName="queryTargetsIndex",sr.queryTargetsKeyPath=["canonicalId","targetId"];var ur=function t(e,n,r){Object(v.a)(this,t),this.targetId=e,this.path=n,this.sequenceNumber=r};ur.store="targetDocuments",ur.keyPath=["targetId","path"],ur.documentTargetsIndex="documentTargetsIndex",ur.documentTargetsKeyPath=["path","targetId"];var cr=function t(e,n,r,i){Object(v.a)(this,t),this.highestTargetId=e,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=i};cr.key="targetGlobalKey",cr.store="targetGlobal";var lr=function t(e,n){Object(v.a)(this,t),this.collectionId=e,this.parent=n};lr.store="collectionParents",lr.keyPath=["collectionId","parent"];var hr=function t(e,n,r,i){Object(v.a)(this,t),this.clientId=e,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=i};hr.store="clientMetadata",hr.keyPath="clientId";var fr=function t(e,n,r){Object(v.a)(this,t),this.bundleId=e,this.createTime=n,this.version=r};fr.store="bundles",fr.keyPath="bundleId";var dr=function t(e,n,r){Object(v.a)(this,t),this.name=e,this.readTime=n,this.bundledQuery=r};dr.store="namedQueries",dr.keyPath="name";[nr.store,rr.store,ir.store,ar.store,sr.store,er.store,cr.store,ur.store].concat([hr.store]).concat([or.store]).concat([lr.store]).concat([fr.store,dr.store]);var pr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",vr=function(){function t(){Object(v.a)(this,t),this.onCommittedListeners=[]}return Object(y.a)(t,[{key:"addOnCommittedListener",value:function(t){this.onCommittedListeners.push(t)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(t){return t()}))}}]),t}(),yr=function(){function t(e){var n=this;Object(v.a)(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(t){n.isDone=!0,n.result=t,n.nextCallback&&n.nextCallback(t)}),(function(t){n.isDone=!0,n.error=t,n.catchCallback&&n.catchCallback(t)}))}return Object(y.a)(t,[{key:"catch",value:function(t){return this.next(void 0,t)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&_(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(t){return n(t)}))})),a=!0,i===r&&t()}))}},{key:"or",value:function(e){var n,r=t.resolve(!1),i=Object(s.a)(e);try{var a=function(){var e=n.value;r=r.next((function(n){return n?t.resolve(n):e()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)}}]),t}();function gr(t){return"IndexedDbTransactionError"===t.name}var mr=function(){function t(e,n,r,i){Object(v.a)(this,t),this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return Object(y.a)(t,[{key:"applyToRemoteDocument",value:function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&De(i,t,n[r])}}},{key:"applyToLocalView",value:function(t){var e,n=Object(s.a)(this.baseMutations);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.key.isEqual(t.key)&&Le(r,t,this.localWriteTime)}}catch(u){n.e(u)}finally{n.f()}var i,a=Object(s.a)(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(t.key)&&Le(o,t,this.localWriteTime)}}catch(u){a.e(u)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Q.min())}))}},{key:"keys",value:function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),cn())}},{key:"isEqual",value:function(t){return this.batchId===t.batchId&&G(this.mutations,t.mutations,(function(t,e){return Me(t,e)}))&&G(this.baseMutations,t.baseMutations,(function(t,e){return Me(t,e)}))}}]),t}(),br=function(){function t(e,n,r,i){Object(v.a)(this,t),this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return Object(y.a)(t,null,[{key:"from",value:function(e,n,r){N(e.mutations.length===r.length);for(var i=sn(),a=e.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new t(e,n,r,i)}}]),t}(),kr=function(){function t(e,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Q.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Q.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:rt.EMPTY_BYTE_STRING;Object(v.a)(this,t),this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return Object(y.a)(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}]),t}(),wr=function t(e){Object(v.a)(this,t),this.Wt=e};function Or(t){var e=Un({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?se(e,e.limit,"L"):e}var Er=function(){function t(){Object(v.a)(this,t),this.Gt=new jr}return Object(y.a)(t,[{key:"addToCollectionParentIndex",value:function(t,e){return this.Gt.add(e),yr.resolve()}},{key:"getCollectionParents",value:function(t,e){return yr.resolve(this.Gt.getEntries(e))}}]),t}(),jr=function(){function t(){Object(v.a)(this,t),this.index={}}return Object(y.a)(t,[{key:"add",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Ze(Z.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}},{key:"has",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}},{key:"getEntries",value:function(t){return(this.index[t]||new Ze(Z.comparator)).toArray()}}]),t}();var Tr=function(){function t(e,n,r){Object(v.a)(this,t),this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Object(y.a)(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(41943040,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);var Ir=function(){function t(e){Object(v.a)(this,t),this.ne=e}return Object(y.a)(t,[{key:"next",value:function(){return this.ne+=2,this.ne}}],[{key:"se",value:function(){return new t(0)}},{key:"ie",value:function(){return new t(-1)}}]),t}();function Sr(t){return xr.apply(this,arguments)}function xr(){return(xr=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.code===L.FAILED_PRECONDITION&&e.message===pr){t.next=2;break}throw e;case 2:S("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ar=function(){function t(e,n){Object(v.a)(this,t),this.mapKeyFn=e,this.equalsFn=n,this.inner={}}return Object(y.a)(t,[{key:"get",value:function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n){var r,i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var a=Object(o.a)(r.value,2),u=a[0],c=a[1];if(this.equalsFn(u,t))return c}}catch(l){i.e(l)}finally{i.f()}}}},{key:"has",value:function(t){return void 0!==this.get(t)}},{key:"set",value:function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]}},{key:"delete",value:function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1}},{key:"forEach",value:function(t){Y(this.inner,(function(e,n){var r,i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var a=Object(o.a)(r.value,2),u=a[0],c=a[1];t(u,c)}}catch(l){i.e(l)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return J(this.inner)}}]),t}(),Cr=function(){function t(){Object(v.a)(this,t),this.changes=new Ar((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return Object(y.a)(t,[{key:"getReadTime",value:function(t){var e=this.changes.get(t);return e?e.readTime:Q.min()}},{key:"addEntry",value:function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}},{key:"removeEntry",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.assertNotApplied(),this.changes.set(t,{document:Ct.newInvalidDocument(t),readTime:e})}},{key:"getEntry",value:function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?yr.resolve(n.document):this.getFromCache(t,e)}},{key:"getEntries",value:function(t,e){return this.getAllFromCache(t,e)}},{key:"apply",value:function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}},{key:"assertNotApplied",value:function(){}}]),t}();var _r=function(){function t(e,n,r){Object(v.a)(this,t),this.He=e,this.In=n,this.Ht=r}return Object(y.a)(t,[{key:"An",value:function(t,e){var n=this;return this.In.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.Rn(t,e,r)}))}},{key:"Rn",value:function(t,e,n){return this.He.getEntry(t,e).next((function(t){var e,r=Object(s.a)(n);try{for(r.s();!(e=r.n()).done;){e.value.applyToLocalView(t)}}catch(i){r.e(i)}finally{r.f()}return t}))}},{key:"bn",value:function(t,e){t.forEach((function(t,n){var r,i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}}))}},{key:"Pn",value:function(t,e){var n=this;return this.He.getEntries(t,e).next((function(e){return n.vn(t,e).next((function(){return e}))}))}},{key:"vn",value:function(t,e){var n=this;return this.In.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.bn(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(t,e,n){return function(t){return pt.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Vn(t,e.path):ie(e)?this.Sn(t,e,n):this.Dn(t,e,n)}},{key:"Vn",value:function(t,e){return this.An(t,new pt(e)).next((function(t){var e=an();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}},{key:"Sn",value:function(t,e,n){var r=this,i=e.collectionGroup,a=an();return this.Ht.getCollectionParents(t,i).next((function(o){return yr.forEach(o,(function(o){var s=function(t,e){return new Jt(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return r.Dn(t,s,n).next((function(t){t.forEach((function(t,e){a=a.insert(t,e)}))}))})).next((function(){return a}))}))}},{key:"Dn",value:function(t,e,n){var r,i,a=this;return this.He.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,a.In.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,a.Cn(t,i,r).next((function(t){r=t;var e,n=Object(s.a)(i);try{for(n.s();!(e=n.n()).done;){var a,o=e.value,u=Object(s.a)(o.mutations);try{for(u.s();!(a=u.n()).done;){var c=a.value,l=c.key,h=r.get(l);null==h&&(h=Ct.newInvalidDocument(l),r=r.insert(l,h)),Le(c,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(l))}}catch(f){u.e(f)}finally{u.f()}}}catch(f){n.e(f)}finally{n.f()}}))})).next((function(){return r.forEach((function(t,n){he(e,n)||(r=r.remove(t))})),r}))}},{key:"Cn",value:function(t,e,n){var r,i=cn(),a=Object(s.a)(e);try{for(a.s();!(r=a.n()).done;){var o,u=r.value,c=Object(s.a)(u.mutations);try{for(c.s();!(o=c.n()).done;){var l=o.value;l instanceof Fe&&null===n.get(l.key)&&(i=i.add(l.key))}}catch(f){c.e(f)}finally{c.f()}}}catch(f){a.e(f)}finally{a.f()}var h=n;return this.He.getEntries(t,i).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(h=h.insert(t,e))})),h}))}}]),t}(),Nr=function(){function t(e,n,r,i){Object(v.a)(this,t),this.targetId=e,this.fromCache=n,this.Nn=r,this.xn=i}return Object(y.a)(t,null,[{key:"kn",value:function(e,n){var r,i=cn(),a=cn(),o=Object(s.a)(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(c){o.e(c)}finally{o.f()}return new t(e,n.fromCache,i,a)}}]),t}(),Dr=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"$n",value:function(t){this.On=t}},{key:"getDocumentsMatchingQuery",value:function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Q.min())?this.Fn(t,e):this.On.Pn(t,r).next((function(a){var o=i.Mn(e,a);return(te(e)||ee(e))&&i.Ln(e.limitType,o,r,n)?i.Fn(t,e):(I()<=b.a.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),le(e)),i.On.getDocumentsMatchingQuery(t,e,n).next((function(t){return o.forEach((function(e){t=t.insert(e.key,e)})),t})))}))}},{key:"Mn",value:function(t,e){var n=new Ze(fe(t));return e.forEach((function(e,r){he(t,r)&&(n=n.add(r))})),n}},{key:"Ln",value:function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Fn",value:function(t,e){return I()<=b.a.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",le(e)),this.On.getDocumentsMatchingQuery(t,e,Q.min())}}]),t}(),Lr=function(){function t(e,n,r,i){Object(v.a)(this,t),this.persistence=e,this.Bn=n,this.N=i,this.Un=new Ye(z),this.qn=new Ar((function(t){return Dt(t)}),Lt),this.Kn=Q.min(),this.In=e.getMutationQueue(r),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new _r(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}return Object(y.a)(t,[{key:"collectGarbage",value:function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Un)}))}}]),t}();function Rr(t,e,n,r){return new Lr(t,e,n,r)}function Mr(t,e){return Pr.apply(this,arguments)}function Pr(){return(Pr=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),i=r.In,a=r.Qn,t.next=4,r.persistence.runTransaction("Handle user change","readonly",(function(t){var e;return r.In.getAllMutationBatches(t).next((function(o){return e=o,i=r.persistence.getMutationQueue(n),a=new _r(r.jn,i,r.persistence.getIndexManager()),i.getAllMutationBatches(t)})).next((function(n){var r,i=[],o=[],u=cn(),c=Object(s.a)(e);try{for(c.s();!(r=c.n()).done;){var l=r.value;i.push(l.batchId);var h,f=Object(s.a)(l.mutations);try{for(f.s();!(h=f.n()).done;){var d=h.value;u=u.add(d.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){c.e(k)}finally{c.f()}var p,v=Object(s.a)(n);try{for(v.s();!(p=v.n()).done;){var y=p.value;o.push(y.batchId);var g,m=Object(s.a)(y.mutations);try{for(m.s();!(g=m.n()).done;){var b=g.value;u=u.add(b.key)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){v.e(k)}finally{v.f()}return a.Pn(t,u).next((function(t){return{Wn:t,removedBatchIds:i,addedBatchIds:o}}))}))}));case 4:return o=t.sent,t.abrupt("return",(r.In=i,r.Qn=a,r.Bn.$n(r.Qn),o));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Vr(t,e){var n=D(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.jn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,a=i.keys(),o=yr.resolve();return a.forEach((function(t){o=o.next((function(){return r.getEntry(e,t)})).next((function(e){var a=n.docVersions.get(t);N(null!==a),e.version.compareTo(a)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),o.next((function(){return t.In.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.In.performConsistencyCheck(t)})).next((function(){return n.Qn.Pn(t,r)}))}))}function Fr(t){var e=D(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ze.getLastRemoteSnapshotVersion(t)}))}function Ur(t,e){var n=D(t),r=e.snapshotVersion,i=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var a=n.jn.newChangeBuffer({trackRemovals:!0});i=n.Un;var o=[];e.targetChanges.forEach((function(e,a){var s=i.get(a);if(s){o.push(n.ze.removeMatchingKeys(t,e.removedDocuments,a).next((function(){return n.ze.addMatchingKeys(t,e.addedDocuments,a)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(a,c),function(t,e,n){return N(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,e)&&o.push(n.ze.updateTargetData(t,c))}}}));var s=nn();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),o.push(Br(t,a,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Q.min())){var u=n.ze.getLastRemoteSnapshotVersion(t).next((function(e){return n.ze.setTargetsMetadata(t,t.currentSequenceNumber,r)}));o.push(u)}return yr.waitFor(o).next((function(){return a.apply(t)})).next((function(){return n.Qn.vn(t,s)})).next((function(){return s}))})).then((function(t){return n.Un=i,t}))}function Br(t,e,n,r,i){var a=cn();return n.forEach((function(t){return a=a.add(t)})),e.getEntries(t,a).next((function(t){var a=nn();return n.forEach((function(n,o){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(Q.min())?(e.removeEntry(n,u),a=a.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(o,u),a=a.insert(n,o)):S("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),a}))}function qr(t,e){var n=D(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.In.getNextMutationBatchAfterBatchId(t,e)}))}function Hr(t,e){var n=D(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ze.getTargetData(t,e).next((function(i){return i?(r=i,yr.resolve(r)):n.ze.allocateTargetId(t).next((function(i){return r=new kr(e,i,0,t.currentSequenceNumber),n.ze.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Un.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(t.targetId,t),n.qn.set(e,t.targetId)),t}))}function Kr(t,e,n){return zr.apply(this,arguments)}function zr(){return(zr=Object(l.a)(c.a.mark((function t(e,n,r){var i,a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=D(e),a=i.Un.get(n),o=r?"readwrite":"readwrite-primary",t.prev=1,t.t0=r,t.t0){t.next=6;break}return t.next=6,i.persistence.runTransaction("Release target",o,(function(t){return i.persistence.referenceDelegate.removeTarget(t,a)}));case 6:t.next=13;break;case 8:if(t.prev=8,t.t1=t.catch(1),gr(t.t1)){t.next=12;break}throw t.t1;case 12:S("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(t.t1));case 13:i.Un=i.Un.remove(n),i.qn.delete(a.target);case 14:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function Gr(t,e,n){var r=D(t),i=Q.min(),a=cn();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=D(t),i=r.qn.get(n);return void 0!==i?yr.resolve(r.Un.get(i)):r.ze.getTargetData(e,n)}(r,t,oe(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(t,e.targetId).next((function(t){a=t}))})).next((function(){return r.Bn.getDocumentsMatchingQuery(t,e,n?i:Q.min(),n?a:cn())})).next((function(t){return{documents:t,Gn:a}}))}))}var Wr=function(){function t(e){Object(v.a)(this,t),this.N=e,this.Yn=new Map,this.Xn=new Map}return Object(y.a)(t,[{key:"getBundleMetadata",value:function(t,e){return yr.resolve(this.Yn.get(e))}},{key:"saveBundleMetadata",value:function(t,e){var n;return this.Yn.set(e.id,{id:(n=e).id,version:n.version,createTime:Sn(n.createTime)}),yr.resolve()}},{key:"getNamedQuery",value:function(t,e){return yr.resolve(this.Xn.get(e))}},{key:"saveNamedQuery",value:function(t,e){return this.Xn.set(e.name,function(t){return{name:t.name,query:Or(t.bundledQuery),readTime:Sn(t.readTime)}}(e)),yr.resolve()}}]),t}(),Qr=function(){function t(){Object(v.a)(this,t),this.Zn=new Ze(Xr.ts),this.es=new Ze(Xr.ns)}return Object(y.a)(t,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(t,e){var n=new Xr(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))}},{key:"removeReference",value:function(t,e){this.rs(new Xr(t,e))}},{key:"os",value:function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))}},{key:"cs",value:function(t){var e=this,n=new pt(new Z([])),r=new Xr(n,t),i=new Xr(n,t+1),a=[];return this.es.forEachInRange([r,i],(function(t){e.rs(t),a.push(t.key)})),a}},{key:"us",value:function(){var t=this;this.Zn.forEach((function(e){return t.rs(e)}))}},{key:"rs",value:function(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}},{key:"hs",value:function(t){var e=new pt(new Z([])),n=new Xr(e,t),r=new Xr(e,t+1),i=cn();return this.es.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i}},{key:"containsKey",value:function(t){var e=new Xr(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}]),t}(),Xr=function(){function t(e,n){Object(v.a)(this,t),this.key=e,this.ls=n}return Object(y.a)(t,null,[{key:"ts",value:function(t,e){return pt.comparator(t.key,e.key)||z(t.ls,e.ls)}},{key:"ns",value:function(t,e){return z(t.ls,e.ls)||pt.comparator(t.key,e.key)}}]),t}(),Yr=function(){function t(e,n){Object(v.a)(this,t),this.Ht=e,this.referenceDelegate=n,this.In=[],this.fs=1,this.ds=new Ze(Xr.ts)}return Object(y.a)(t,[{key:"checkEmpty",value:function(t){return yr.resolve(0===this.In.length)}},{key:"addMutationBatch",value:function(t,e,n,r){var i=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];var a=new mr(i,e,n,r);this.In.push(a);var o,u=Object(s.a)(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;this.ds=this.ds.add(new Xr(c.key,i)),this.Ht.addToCollectionParentIndex(t,c.key.path.popLast())}}catch(l){u.e(l)}finally{u.f()}return yr.resolve(a)}},{key:"lookupMutationBatch",value:function(t,e){return yr.resolve(this.ws(e))}},{key:"getNextMutationBatchAfterBatchId",value:function(t,e){var n=e+1,r=this._s(n),i=r<0?0:r;return yr.resolve(this.In.length>i?this.In[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return yr.resolve(0===this.In.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(t){return yr.resolve(this.In.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,e){var n=this,r=new Xr(e,0),i=new Xr(e,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],(function(t){var e=n.ws(t.ls);a.push(e)})),yr.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,e){var n=this,r=new Ze(z);return e.forEach((function(t){var e=new Xr(t,0),i=new Xr(t,Number.POSITIVE_INFINITY);n.ds.forEachInRange([e,i],(function(t){r=r.add(t.ls)}))})),yr.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,e){var n=e.path,r=n.length+1,i=n;pt.isDocumentKey(i)||(i=i.child(""));var a=new Xr(new pt(i),0),o=new Ze(z);return this.ds.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.ls)),!0)}),a),yr.resolve(this.gs(o))}},{key:"gs",value:function(t){var e=this,n=[];return t.forEach((function(t){var r=e.ws(t);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(t,e){var n=this;N(0===this.ys(e.batchId,"removed")),this.In.shift();var r=this.ds;return yr.forEach(e.mutations,(function(i){var a=new Xr(i.key,e.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.ds=r}))}},{key:"te",value:function(t){}},{key:"containsKey",value:function(t,e){var n=new Xr(e,0),r=this.ds.firstAfterOrEqual(n);return yr.resolve(e.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(t){return this.In.length,yr.resolve()}},{key:"ys",value:function(t,e){return this._s(t)}},{key:"_s",value:function(t){return 0===this.In.length?0:t-this.In[0].batchId}},{key:"ws",value:function(t){var e=this._s(t);return e<0||e>=this.In.length?null:this.In[e]}}]),t}(),Jr=function(){function t(e,n){Object(v.a)(this,t),this.Ht=e,this.ps=n,this.docs=new Ye(pt.comparator),this.size=0}return Object(y.a)(t,[{key:"addEntry",value:function(t,e,n){var r=e.key,i=this.docs.get(r),a=i?i.size:0,o=this.ps(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:o,readTime:n}),this.size+=o-a,this.Ht.addToCollectionParentIndex(t,r.path.popLast())}},{key:"removeEntry",value:function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}},{key:"getEntry",value:function(t,e){var n=this.docs.get(e);return yr.resolve(n?n.document.clone():Ct.newInvalidDocument(e))}},{key:"getEntries",value:function(t,e){var n=this,r=nn();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ct.newInvalidDocument(t))})),yr.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(t,e,n){for(var r=nn(),i=new pt(e.path.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||he(e,c)&&(r=r.insert(c.key,c.clone()))}return yr.resolve(r)}},{key:"Ts",value:function(t,e){return yr.forEach(this.docs,(function(t){return e(t)}))}},{key:"newChangeBuffer",value:function(t){return new $r(this)}},{key:"getSize",value:function(t){return yr.resolve(this.size)}}]),t}(),$r=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).Se=t,r}return Object(y.a)(n,[{key:"applyChanges",value:function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Se.addEntry(t,i.document,e.getReadTime(r))):e.Se.removeEntry(r)})),yr.waitFor(n)}},{key:"getFromCache",value:function(t,e){return this.Se.getEntry(t,e)}},{key:"getAllFromCache",value:function(t,e){return this.Se.getEntries(t,e)}}]),n}(Cr),Zr=function(){function t(e){Object(v.a)(this,t),this.persistence=e,this.Es=new Ar((function(t){return Dt(t)}),Lt),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Is=0,this.As=new Qr,this.targetCount=0,this.Rs=Ir.se()}return Object(y.a)(t,[{key:"forEachTarget",value:function(t,e){return this.Es.forEach((function(t,n){return e(n)})),yr.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(t){return yr.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(t){return yr.resolve(this.Is)}},{key:"allocateTargetId",value:function(t){return this.highestTargetId=this.Rs.next(),yr.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Is&&(this.Is=e),yr.resolve()}},{key:"ae",value:function(t){this.Es.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Rs=new Ir(e),this.highestTargetId=e),t.sequenceNumber>this.Is&&(this.Is=t.sequenceNumber)}},{key:"addTargetData",value:function(t,e){return this.ae(e),this.targetCount+=1,yr.resolve()}},{key:"updateTargetData",value:function(t,e){return this.ae(e),yr.resolve()}},{key:"removeTargetData",value:function(t,e){return this.Es.delete(e.target),this.As.cs(e.targetId),this.targetCount-=1,yr.resolve()}},{key:"removeTargets",value:function(t,e,n){var r=this,i=0,a=[];return this.Es.forEach((function(o,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.Es.delete(o),a.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),yr.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(t){return yr.resolve(this.targetCount)}},{key:"getTargetData",value:function(t,e){var n=this.Es.get(e)||null;return yr.resolve(n)}},{key:"addMatchingKeys",value:function(t,e,n){return this.As.ss(e,n),yr.resolve()}},{key:"removeMatchingKeys",value:function(t,e,n){this.As.os(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),yr.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(t,e){return this.As.cs(e),yr.resolve()}},{key:"getMatchingKeysForTargetId",value:function(t,e){var n=this.As.hs(e);return yr.resolve(n)}},{key:"containsKey",value:function(t,e){return yr.resolve(this.As.containsKey(e))}}]),t}(),ti=function(){function t(e,n){var r=this;Object(v.a)(this,t),this.bs={},this.Le=new q(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new Zr(this),this.Ht=new Er,this.He=function(t,e){return new Jr(t,(function(t){return r.referenceDelegate.Ps(t)}))}(this.Ht),this.N=new wr(n),this.Je=new Wr(this.N)}return Object(y.a)(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Be=!1,Promise.resolve()}},{key:"started",get:function(){return this.Be}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(){return this.Ht}},{key:"getMutationQueue",value:function(t){var e=this.bs[t.toKey()];return e||(e=new Yr(this.Ht,this.referenceDelegate),this.bs[t.toKey()]=e),e}},{key:"getTargetCache",value:function(){return this.ze}},{key:"getRemoteDocumentCache",value:function(){return this.He}},{key:"getBundleCache",value:function(){return this.Je}},{key:"runTransaction",value:function(t,e,n){var r=this;S("MemoryPersistence","Starting transaction:",t);var i=new ei(this.Le.next());return this.referenceDelegate.vs(),n(i).next((function(t){return r.referenceDelegate.Vs(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))}},{key:"Ss",value:function(t,e){return yr.or(Object.values(this.bs).map((function(n){return function(){return n.containsKey(t,e)}})))}}]),t}(),ei=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).currentSequenceNumber=t,r}return n}(vr),ni=function(){function t(e){Object(v.a)(this,t),this.persistence=e,this.Ds=new Qr,this.Cs=null}return Object(y.a)(t,[{key:"xs",get:function(){if(this.Cs)return this.Cs;throw _()}},{key:"addReference",value:function(t,e,n){return this.Ds.addReference(n,e),this.xs.delete(n.toString()),yr.resolve()}},{key:"removeReference",value:function(t,e,n){return this.Ds.removeReference(n,e),this.xs.add(n.toString()),yr.resolve()}},{key:"markPotentiallyOrphaned",value:function(t,e){return this.xs.add(e.toString()),yr.resolve()}},{key:"removeTarget",value:function(t,e){var n=this;this.Ds.cs(e.targetId).forEach((function(t){return n.xs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.xs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))}},{key:"vs",value:function(){this.Cs=new Set}},{key:"Vs",value:function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return yr.forEach(this.xs,(function(r){var i=pt.fromPath(r);return e.ks(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Cs=null,n.apply(t)}))}},{key:"updateLimboDocument",value:function(t,e){var n=this;return this.ks(t,e).next((function(t){t?n.xs.delete(e.toString()):n.xs.add(e.toString())}))}},{key:"Ps",value:function(t){return 0}},{key:"ks",value:function(t,e){var n=this;return yr.or([function(){return yr.resolve(n.Ds.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Ss(t,e)}])}}],[{key:"Ns",value:function(e){return new t(e)}}]),t}();var ri=function(){function t(){Object(v.a)(this,t),this.activeTargetIds=hn()}return Object(y.a)(t,[{key:"Fs",value:function(t){this.activeTargetIds=this.activeTargetIds.add(t)}},{key:"Ms",value:function(t){this.activeTargetIds=this.activeTargetIds.delete(t)}},{key:"Os",value:function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}]),t}(),ii=function(){function t(){Object(v.a)(this,t),this.yi=new ri,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Object(y.a)(t,[{key:"addPendingMutation",value:function(t){}},{key:"updateMutationState",value:function(t,e,n){}},{key:"addLocalQueryTarget",value:function(t){return this.yi.Fs(t),this.pi[t]||"not-current"}},{key:"updateQueryState",value:function(t,e,n){this.pi[t]=e}},{key:"removeLocalQueryTarget",value:function(t){this.yi.Ms(t)}},{key:"isLocalQueryTarget",value:function(t){return this.yi.activeTargetIds.has(t)}},{key:"clearQueryState",value:function(t){delete this.pi[t]}},{key:"getAllActiveQueryTargets",value:function(){return this.yi.activeTargetIds}},{key:"isActiveQueryTarget",value:function(t){return this.yi.activeTargetIds.has(t)}},{key:"start",value:function(){return this.yi=new ri,Promise.resolve()}},{key:"handleUserChange",value:function(t,e,n){}},{key:"setOnlineState",value:function(t){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(t){}},{key:"notifyBundleLoaded",value:function(){}}]),t}(),ai=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"Ti",value:function(t){}},{key:"shutdown",value:function(){}}]),t}(),oi=function(){function t(){var e=this;Object(v.a)(this,t),this.Ei=function(){return e.Ii()},this.Ai=function(){return e.Ri()},this.bi=[],this.Pi()}return Object(y.a)(t,[{key:"Ti",value:function(t){this.bi.push(t)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ai)}},{key:"Pi",value:function(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ai)}},{key:"Ii",value:function(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var t,e=Object(s.a)(this.bi);try{for(e.s();!(t=e.n()).done;){(0,t.value)(0)}}catch(n){e.e(n)}finally{e.f()}}},{key:"Ri",value:function(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var t,e=Object(s.a)(this.bi);try{for(e.s();!(t=e.n()).done;){(0,t.value)(1)}}catch(n){e.e(n)}finally{e.f()}}}],[{key:"bt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),si={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ui=function(){function t(e){Object(v.a)(this,t),this.vi=e.vi,this.Vi=e.Vi}return Object(y.a)(t,[{key:"Si",value:function(t){this.Di=t}},{key:"Ci",value:function(t){this.Ni=t}},{key:"onMessage",value:function(t){this.xi=t}},{key:"close",value:function(){this.Vi()}},{key:"send",value:function(t){this.vi(t)}},{key:"ki",value:function(){this.Di()}},{key:"$i",value:function(t){this.Ni(t)}},{key:"Oi",value:function(t){this.xi(t)}}]),t}(),ci=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this,t)).forceLongPolling=t.forceLongPolling,r.autoDetectLongPolling=t.autoDetectLongPolling,r.useFetchStreams=t.useFetchStreams,r}return Object(y.a)(n,[{key:"qi",value:function(t,e,n,r){return new Promise((function(i,a){var o=new w.g;o.listenOnce(w.c.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case w.a.NO_ERROR:var e=o.getResponseJson();S("Connection","XHR received:",JSON.stringify(e)),i(e);break;case w.a.TIMEOUT:S("Connection",'RPC "'+t+'" timed out'),a(new R(L.DEADLINE_EXCEEDED,"Request time out"));break;case w.a.HTTP_ERROR:var n=o.getStatus();if(S("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(e)>=0?e:L.UNKNOWN}(r.status);a(new R(s,r.message))}else a(new R(L.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new R(L.UNAVAILABLE,"Connection failed."));break;default:_()}}finally{S("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);o.send(e,"POST",s,n,15)}))}},{key:"ji",value:function(t,e){var n=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Object(w.h)(),i=Object(w.i)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new w.d({})),this.Ui(a.initMessageHeaders,e),Object(k.n)()||Object(k.o)()||Object(k.k)()||Object(k.l)()||Object(k.q)()||Object(k.j)()||(a.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");S("Connection","Creating WebChannel: "+o,a);var s=r.createWebChannel(o,a),u=!1,c=!1,l=new ui({vi:function(t){c?S("Connection","Not sending because WebChannel is closed:",t):(u||(S("Connection","Opening WebChannel transport."),s.open(),u=!0),S("Connection","WebChannel sending:",t),s.send(t))},Vi:function(){return s.close()}}),h=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return h(s,w.f.EventType.OPEN,(function(){c||S("Connection","WebChannel transport opened.")})),h(s,w.f.EventType.CLOSE,(function(){c||(c=!0,S("Connection","WebChannel transport closed"),l.$i())})),h(s,w.f.EventType.ERROR,(function(t){c||(c=!0,A("Connection","WebChannel transport errored:",t),l.$i(new R(L.UNAVAILABLE,"The operation could not be completed")))})),h(s,w.f.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];N(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){S("Connection","WebChannel received error:",i);var a=i.status,o=function(t){var e=He[t];if(void 0!==e)return Xe(e)}(a),u=i.message;void 0===o&&(o=L.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),c=!0,l.$i(new R(o,u)),s.close()}else S("Connection","WebChannel received:",n),l.Oi(n)}})),h(i,w.b.STAT_EVENT,(function(t){t.stat===w.e.PROXY?S("Connection","Detected buffering proxy"):t.stat===w.e.NOPROXY&&S("Connection","Detected no buffering proxy")})),setTimeout((function(){l.ki()}),0),l}}]),n}(function(){function t(e){Object(v.a)(this,t),this.databaseInfo=e,this.databaseId=e.databaseId;var n=e.ssl?"https":"http";this.Fi=n+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Object(y.a)(t,[{key:"Li",value:function(t,e,n,r){var i=this.Bi(t,e);S("RestConnection","Sending: ",i,n);var a={};return this.Ui(a,r),this.qi(t,i,a,n).then((function(t){return S("RestConnection","Received: ",t),t}),(function(e){throw A("RestConnection","".concat(t," failed with error: "),e,"url: ",i,"request:",n),e}))}},{key:"Ki",value:function(t,e,n,r){return this.Li(t,e,n,r)}},{key:"Ui",value:function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+j,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])}},{key:"Bi",value:function(t,e){var n=si[t];return"".concat(this.Fi,"/v1/").concat(e,":").concat(n)}}]),t}());function li(){return"undefined"!=typeof document?document:null}function hi(t){return new En(t,!0)}var fi=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;Object(v.a)(this,t),this.Oe=e,this.timerId=n,this.Qi=r,this.Wi=i,this.Gi=a,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}return Object(y.a)(t,[{key:"reset",value:function(){this.zi=0}},{key:"Yi",value:function(){this.zi=this.Gi}},{key:"Xi",value:function(t){var e=this;this.cancel();var n=Math.floor(this.zi+this.Zi()),r=Math.max(0,Date.now()-this.Ji),i=Math.max(0,n-r);i>0&&S("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.zi," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,i,(function(){return e.Ji=Date.now(),t()})),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}},{key:"tr",value:function(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}},{key:"cancel",value:function(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}},{key:"Zi",value:function(){return(Math.random()-.5)*this.zi}}]),t}(),di=function(){function t(e,n,r,i,a,o){Object(v.a)(this,t),this.Oe=e,this.er=r,this.nr=i,this.credentialsProvider=a,this.listener=o,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new fi(e,n)}return Object(y.a)(t,[{key:"ar",value:function(){return 1===this.state||2===this.state||4===this.state}},{key:"cr",value:function(){return 2===this.state}},{key:"start",value:function(){3!==this.state?this.auth():this.ur()}},{key:"stop",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.ar(),!t.t0){t.next=4;break}return t.next=4,this.close(0);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hr",value:function(){this.state=0,this.rr.reset()}},{key:"lr",value:function(){var t=this;this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,(function(){return t.dr()})))}},{key:"wr",value:function(t){this._r(),this.stream.send(t)}},{key:"dr",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cr()){t.next=2;break}return t.abrupt("return",this.close(0));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_r",value:function(){this.ir&&(this.ir.cancel(),this.ir=null)}},{key:"close",value:function(){var t=Object(l.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._r(),this.rr.cancel(),this.sr++,3!==e?this.rr.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(x(n.toString()),x("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):n&&n.code===L.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,t.next=8,this.listener.Ci(n);case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"mr",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var e=this.gr(this.sr),n=this.sr;this.credentialsProvider.getToken().then((function(e){t.sr===n&&t.yr(e)}),(function(n){e((function(){var e=new R(L.UNKNOWN,"Fetching auth token failed: "+n.message);return t.pr(e)}))}))}},{key:"yr",value:function(t){var e=this,n=this.gr(this.sr);this.stream=this.Tr(t),this.stream.Si((function(){n((function(){return e.state=2,e.listener.Si()}))})),this.stream.Ci((function(t){n((function(){return e.pr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))}},{key:"ur",value:function(){var t=this;this.state=4,this.rr.Xi(Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),e)}))))}},{key:"pr",value:function(t){return S("PersistentStream","close with error: ".concat(t)),this.stream=null,this.close(3,t)}},{key:"gr",value:function(t){var e=this;return function(n){e.Oe.enqueueAndForget((function(){return e.sr===t?n():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),pi=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i,a,o){var s;return Object(v.a)(this,n),(s=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",r,i,o)).N=a,s}return Object(y.a)(n,[{key:"Tr",value:function(t){return this.nr.ji("Listen",t)}},{key:"onMessage",value:function(t){this.rr.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:_()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(t,e){return t.D?(N(void 0===e||"string"==typeof e),rt.fromBase64String(e||"")):(N(void 0===e||e instanceof Uint8Array),rt.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,s=o&&function(t){var e=void 0===t.code?L.UNKNOWN:Xe(t.code);return new R(e,t.message||"")}(o);n=new yn(r,i,a,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var c=_n(t,u.document.name),l=Sn(u.document.updateTime),h=new xt({mapValue:{fields:u.document.fields}}),f=Ct.newFoundDocument(c,l,h),d=u.targetIds||[],p=u.removedTargetIds||[];n=new pn(d,p,f.key,f)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var y=_n(t,v.document),g=v.readTime?Sn(v.readTime):Q.min(),m=Ct.newNoDocument(y,g),b=v.removedTargetIds||[];n=new pn([],b,m.key,m)}else if("documentRemove"in e){e.documentRemove;var k=e.documentRemove;k.document;var w=_n(t,k.document),O=k.removedTargetIds||[];n=new pn([],O,w,null)}else{if(!("filter"in e))return _();e.filter;var E=e.filter;E.targetId;var j=E.count||0,T=new We(j),I=E.targetId;n=new vn(I,T)}return n}(this.N,t),n=function(t){if(!("targetChange"in t))return Q.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Q.min():e.readTime?Sn(e.readTime):Q.min()}(t);return this.listener.Er(e,n)}},{key:"Ir",value:function(t){var e={};e.database=Ln(this.N),e.addTarget=function(t,e){var n,r=e.target;return(n=Rt(r)?{documents:Vn(t,r)}:{query:Fn(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Tn(t,e.resumeToken):e.snapshotVersion.compareTo(Q.min())>0&&(n.readTime=jn(t,e.snapshotVersion.toTimestamp())),n}(this.N,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.N,t);n&&(e.labels=n),this.wr(e)}},{key:"Ar",value:function(t){var e={};e.database=Ln(this.N),e.removeTarget=t,this.wr(e)}}]),n}(di),vi=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i,a,o){var s;return Object(v.a)(this,n),(s=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",r,i,o)).N=a,s.Rr=!1,s}return Object(y.a)(n,[{key:"br",get:function(){return this.Rr}},{key:"start",value:function(){this.Rr=!1,this.lastStreamToken=void 0,Object(i.a)(Object(a.a)(n.prototype),"start",this).call(this)}},{key:"mr",value:function(){this.Rr&&this.Pr([])}},{key:"Tr",value:function(t){return this.nr.ji("Write",t)}},{key:"onMessage",value:function(t){if(N(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();var e=function(t,e){return t&&t.length>0?(N(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Sn(t.updateTime):Sn(e);return n.isEqual(Q.min())&&(n=Sn(e)),new Ae(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Sn(t.commitTime);return this.listener.vr(n,e)}return N(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()}},{key:"Sr",value:function(){var t={};t.database=Ln(this.N),this.wr(t)}},{key:"Pr",value:function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Pn(e.N,t)}))};this.wr(n)}}]),n}(di),yi=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).credentials=t,a.nr=r,a.N=i,a.Dr=!1,a}return Object(y.a)(n,[{key:"Cr",value:function(){if(this.Dr)throw new R(L.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Li",value:function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.nr.Li(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===L.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new R(L.UNKNOWN,t.toString())}))}},{key:"Ki",value:function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.nr.Ki(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===L.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new R(L.UNKNOWN,t.toString())}))}},{key:"terminate",value:function(){this.Dr=!0}}]),n}(function(){return function t(){Object(v.a)(this,t)}}()),gi=function(){function t(e,n){Object(v.a)(this,t),this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}return Object(y.a)(t,[{key:"Or",value:function(){var t=this;0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.kr=null,t.Mr("Backend didn't respond within 10 seconds."),t.Fr("Offline"),Promise.resolve()})))}},{key:"Lr",value:function(t){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.Fr("Offline")))}},{key:"set",value:function(t){this.Br(),this.Nr=0,"Online"===t&&(this.$r=!1),this.Fr(t)}},{key:"Fr",value:function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}},{key:"Mr",value:function(t){var e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.$r?(x(e),this.$r=!1):S("OnlineStateTracker",e)}},{key:"Br",value:function(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}]),t}(),mi=function t(e,n,r,i,a){var o=this;Object(v.a)(this,t),this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=a,this.Qr.Ti((function(t){r.enqueueAndForget(Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Ai(o),!t.t0){t.next=5;break}return S("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=Object(l.a)(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=D(e)).Kr.add(4),t.next=4,wi(n);case 4:return n.Wr.set("Unknown"),n.Kr.delete(4),t.next=8,bi(n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(o);case 5:case"end":return t.stop()}}),t)}))))})),this.Wr=new gi(r,i)};function bi(t){return ki.apply(this,arguments)}function ki(){return(ki=Object(l.a)(c.a.mark((function t(e){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Ai(e)){t.next=18;break}n=Object(s.a)(e.jr),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return i=r.value,t.next=8,i(!0);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))).apply(this,arguments)}function wi(t){return Oi.apply(this,arguments)}function Oi(){return(Oi=Object(l.a)(c.a.mark((function t(e){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(s.a)(e.jr),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=9;break}return i=r.value,t.next=7,i(!1);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))).apply(this,arguments)}function Ei(t,e){var n=D(t);n.qr.has(e.targetId)||(n.qr.set(e.targetId,e),xi(n)?Si(n):na(n).cr()&&Ti(n,e))}function ji(t,e){var n=D(t),r=na(n);n.qr.delete(e),r.cr()&&Ii(n,e),0===n.qr.size&&(r.cr()?r.lr():Ai(n)&&n.Wr.set("Unknown"))}function Ti(t,e){t.Gr.Y(e.targetId),na(t).Ir(e)}function Ii(t,e){t.Gr.Y(e),na(t).Ar(e)}function Si(t){t.Gr=new mn({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},Tt:function(e){return t.qr.get(e)||null}}),na(t).start(),t.Wr.Or()}function xi(t){return Ai(t)&&!na(t).ar()&&t.qr.size>0}function Ai(t){return 0===D(t).Kr.size}function Ci(t){t.Gr=void 0}function _i(t){return Ni.apply(this,arguments)}function Ni(){return(Ni=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.qr.forEach((function(t,n){Ti(e,t)}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Di(t,e){return Li.apply(this,arguments)}function Li(){return(Li=Object(l.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Ci(e),xi(e)?(e.Wr.Lr(n),Si(e)):e.Wr.set("Unknown");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ri(t,e,n){return Mi.apply(this,arguments)}function Mi(){return Mi=Object(l.a)(c.a.mark((function t(e,n,r){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.Wr.set("Online"),!(n instanceof yn&&2===n.state&&n.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.cause,i=Object(s.a)(n.targetIds),t.prev=2,i.s();case 4:if((a=i.n()).done){t.next=14;break}if(o=a.value,t.t0=e.qr.has(o),!t.t0){t.next=12;break}return t.next=10,e.remoteSyncer.rejectListen(o,r);case 10:e.qr.delete(o),e.Gr.removeTarget(o);case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(2),i.e(t.t1);case 19:return t.prev=19,i.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})));return function(e,n){return t.apply(this,arguments)}}()(e,n);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),S("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),t.t0),t.next=11,Pi(e,t.t0);case 11:case 22:t.next=29;break;case 13:if(n instanceof pn?e.Gr.rt(n):n instanceof vn?e.Gr.ft(n):e.Gr.ct(n),r.isEqual(Q.min())){t.next=29;break}return t.prev=14,t.next=17,Fr(e.localStore);case 17:if(i=t.sent,t.t1=r.compareTo(i)>=0,!t.t1){t.next=22;break}return t.next=22,function(t,e){var n=t.Gr._t(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.qr.get(r);i&&t.qr.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.qr.get(e);if(n){t.qr.set(e,n.withResumeToken(rt.EMPTY_BYTE_STRING,n.snapshotVersion)),Ii(t,e);var r=new kr(n.target,e,1,n.sequenceNumber);Ti(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(e,r);case 24:return t.prev=24,t.t2=t.catch(14),S("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,Pi(e,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),Mi.apply(this,arguments)}function Pi(t,e,n){return Vi.apply(this,arguments)}function Vi(){return(Vi=Object(l.a)(c.a.mark((function t(e,n,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(gr(n)){t.next=2;break}throw n;case 2:return e.Kr.add(1),t.next=5,wi(e);case 5:e.Wr.set("Offline"),r||(r=function(){return Fr(e.localStore)}),e.asyncQueue.enqueueRetryable(Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S("RemoteStore","Retrying IndexedDB access"),t.next=3,r();case 3:return e.Kr.delete(1),t.next=6,bi(e);case 6:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fi(t,e){return e().catch((function(n){return Pi(t,n,e)}))}function Ui(t){return Bi.apply(this,arguments)}function Bi(){return(Bi=Object(l.a)(c.a.mark((function t(e){var n,r,i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=D(e),r=ra(n),i=n.Ur.length>0?n.Ur[n.Ur.length-1].batchId:-1;case 2:if(!qi(n)){t.next=19;break}return t.prev=3,t.next=6,qr(n.localStore,i);case 6:if(null!==(a=t.sent)){t.next=10;break}return 0===n.Ur.length&&r.lr(),t.abrupt("break",19);case 10:i=a.batchId,Hi(n,a),t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(3),t.next=17,Pi(n,t.t0);case 17:t.next=2;break;case 19:Ki(n)&&zi(n);case 20:case"end":return t.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function qi(t){return Ai(t)&&t.Ur.length<10}function Hi(t,e){t.Ur.push(e);var n=ra(t);n.cr()&&n.br&&n.Pr(e.mutations)}function Ki(t){return Ai(t)&&!ra(t).ar()&&t.Ur.length>0}function zi(t){ra(t).start()}function Gi(t){return Wi.apply(this,arguments)}function Wi(){return(Wi=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:ra(e).Sr();case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qi(t){return Xi.apply(this,arguments)}function Xi(){return(Xi=Object(l.a)(c.a.mark((function t(e){var n,r,i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=ra(e),r=Object(s.a)(e.Ur);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Pr(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yi(t,e,n){return Ji.apply(this,arguments)}function Ji(){return(Ji=Object(l.a)(c.a.mark((function t(e,n,r){var i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.Ur.shift(),a=br.from(i,n,r),t.next=3,Fi(e,(function(){return e.remoteSyncer.applySuccessfulWrite(a)}));case 3:return t.next=5,Ui(e);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $i(t,e){return Zi.apply(this,arguments)}function Zi(){return Zi=Object(l.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n&&ra(e).br,!t.t0){t.next=4;break}return t.next=4,function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe(i=n.code)||i===L.ABORTED){t.next=7;break}return r=e.Ur.shift(),ra(e).hr(),t.next=5,Fi(e,(function(){return e.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return t.next=7,Ui(e);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(e,n);case 4:Ki(e)&&zi(e);case 5:case"end":return t.stop()}}),t)}))),Zi.apply(this,arguments)}function ta(t,e){return ea.apply(this,arguments)}function ea(){return(ea=Object(l.a)(c.a.mark((function t(e,n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=D(e),!n){t.next=7;break}return r.Kr.delete(2),t.next=5,bi(r);case 5:t.next=13;break;case 7:if(t.t0=n,t.t0){t.next=13;break}return r.Kr.add(2),t.next=12,wi(r);case 12:r.Wr.set("Unknown");case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function na(t){return t.zr||(t.zr=function(t,e,n){var r=D(t);return r.Cr(),new pi(e,r.nr,r.credentials,r.N,n)}(t.datastore,t.asyncQueue,{Si:_i.bind(null,t),Ci:Di.bind(null,t),Er:Ri.bind(null,t)}),t.jr.push(function(){var e=Object(l.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}t.zr.hr(),xi(t)?Si(t):t.Wr.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.zr.stop();case 6:Ci(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),t.zr}function ra(t){return t.Hr||(t.Hr=function(t,e,n){var r=D(t);return r.Cr(),new vi(e,r.nr,r.credentials,r.N,n)}(t.datastore,t.asyncQueue,{Si:Gi.bind(null,t),Ci:$i.bind(null,t),Vr:Qi.bind(null,t),vr:Yi.bind(null,t)}),t.jr.push(function(){var e=Object(l.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return t.Hr.hr(),e.next=4,Ui(t);case 4:e.next=9;break;case 6:return e.next=8,t.Hr.stop();case 8:t.Ur.length>0&&(S("RemoteStore","Stopping write stream with ".concat(t.Ur.length," pending writes")),t.Ur=[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),t.Hr}var ia=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new M,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return Object(y.a)(t,[{key:"start",value:function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new R(L.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}},{key:"handleDelayElapsed",value:function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o}}]),t}();function aa(t,e){if(x("AsyncQueue","".concat(e,": ").concat(t)),gr(t))return new R(L.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}var oa=function(){function t(e){Object(v.a)(this,t),this.comparator=e?function(t,n){return e(t,n)||pt.comparator(t.key,n.key)}:function(t,e){return pt.comparator(t.key,e.key)},this.keyedMap=an(),this.sortedSet=new Ye(this.comparator)}return Object(y.a)(t,[{key:"has",value:function(t){return null!=this.keyedMap.get(t)}},{key:"get",value:function(t){return this.keyedMap.get(t)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"add",value:function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}},{key:"delete",value:function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),sa=function(){function t(){Object(v.a)(this,t),this.Jr=new Ye(pt.comparator)}return Object(y.a)(t,[{key:"track",value:function(t){var e=t.doc.key,n=this.Jr.get(e);n?0!==t.type&&3===n.type?this.Jr=this.Jr.insert(e,t):3===t.type&&1!==n.type?this.Jr=this.Jr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Jr=this.Jr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Jr=this.Jr.remove(e):1===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):_():this.Jr=this.Jr.insert(e,t)}},{key:"Yr",value:function(){var t=[];return this.Jr.inorderTraversal((function(e,n){t.push(n)})),t}}]),t}(),ua=function(){function t(e,n,r,i,a,o,s,u){Object(v.a)(this,t),this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return Object(y.a)(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ue(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i){var a=[];return n.forEach((function(t){a.push({type:0,doc:t})})),new t(e,n,oa.emptySet(n),a,r,i,!0,!1)}}]),t}(),ca=function t(){Object(v.a)(this,t),this.Xr=void 0,this.listeners=[]},la=function t(){Object(v.a)(this,t),this.queries=new Ar((function(t){return ce(t)}),ue),this.onlineState="Unknown",this.Zr=new Set};function ha(t,e){return fa.apply(this,arguments)}function fa(){return(fa=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=D(e),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new ca),!a){t.next=13;break}return t.prev=3,t.next=6,r.onListen(i);case 6:o.Xr=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(3),s=aa(t.t0,"Initialization of query '".concat(le(n.query),"' failed")),t.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.eo(r.onlineState),o.Xr&&n.no(o.Xr)&&ga(r);case 14:case"end":return t.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function da(t,e){return pa.apply(this,arguments)}function pa(){return(pa=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=D(e),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){t.next=6;break}return t.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function va(t,e){var n,r=D(t),i=!1,a=Object(s.a)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,c=r.queries.get(u);if(c){var l,h=Object(s.a)(c.listeners);try{for(h.s();!(l=h.n()).done;){l.value.no(o)&&(i=!0)}}catch(f){h.e(f)}finally{h.f()}c.Xr=o}}}catch(f){a.e(f)}finally{a.f()}i&&ga(r)}function ya(t,e,n){var r=D(t),i=r.queries.get(e);if(i){var a,o=Object(s.a)(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(e)}function ga(t){t.Zr.forEach((function(t){t.next()}))}var ma=function(){function t(e,n,r){Object(v.a)(this,t),this.query=e,this.so=n,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=r||{}}return Object(y.a)(t,[{key:"no",value:function(t){if(!this.options.includeMetadataChanges){var e,n=[],r=Object(s.a)(t.docChanges);try{for(r.s();!(e=r.n()).done;){var i=e.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}t=new ua(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var a=!1;return this.io?this.oo(t)&&(this.so.next(t),a=!0):this.ao(t,this.onlineState)&&(this.co(t),a=!0),this.ro=t,a}},{key:"onError",value:function(t){this.so.error(t)}},{key:"eo",value:function(t){this.onlineState=t;var e=!1;return this.ro&&!this.io&&this.ao(this.ro,t)&&(this.co(this.ro),e=!0),e}},{key:"ao",value:function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return(!this.options.uo||!n)&&(!t.docs.isEmpty()||"Offline"===e)}},{key:"oo",value:function(t){if(t.docChanges.length>0)return!0;var e=this.ro&&this.ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}},{key:"co",value:function(t){t=ua.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.io=!0,this.so.next(t)}}]),t}();var ba=function t(e){Object(v.a)(this,t),this.key=e},ka=function t(e){Object(v.a)(this,t),this.key=e},wa=function(){function t(e,n){Object(v.a)(this,t),this.query=e,this._o=n,this.mo=null,this.current=!1,this.yo=cn(),this.mutatedKeys=cn(),this.po=fe(e),this.To=new oa(this.po)}return Object(y.a)(t,[{key:"Eo",get:function(){return this._o}},{key:"Io",value:function(t,e){var n=this,r=e?e.Ao:new sa,i=e?e.To:this.To,a=e?e.mutatedKeys:this.mutatedKeys,o=i,s=!1,u=te(this.query)&&i.size===this.query.limit?i.last():null,c=ee(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=he(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.Ro(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.po(h,u)>0||c&&n.po(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(o=o.add(h),a=d?a.add(t):a.delete(t)):(o=o.delete(t),a=a.delete(t)))})),te(this.query)||ee(this.query))for(;o.size>this.query.limit;){var l=te(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{To:o,Ao:r,Ln:s,mutatedKeys:a}}},{key:"Ro",value:function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}},{key:"applyChanges",value:function(t,e,n){var r=this,i=this.To;this.To=t.To,this.mutatedKeys=t.mutatedKeys;var a=t.Ao.Yr();a.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _()}};return n(t)-n(e)}(t.type,e.type)||r.po(t.doc,e.doc)})),this.bo(n);var o=e?this.Po():[],s=0===this.yo.size&&this.current?1:0,u=s!==this.mo;return this.mo=s,0!==a.length||u?{snapshot:new ua(this.query,t.To,i,a,t.mutatedKeys,0===s,u,!1),vo:o}:{vo:o}}},{key:"eo",value:function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({To:this.To,Ao:new sa,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}},{key:"Vo",value:function(t){return!this._o.has(t)&&!!this.To.has(t)&&!this.To.get(t).hasLocalMutations}},{key:"bo",value:function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._o=e._o.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e._o=e._o.delete(t)})),this.current=t.current)}},{key:"Po",value:function(){var t=this;if(!this.current)return[];var e=this.yo;this.yo=cn(),this.To.forEach((function(e){t.Vo(e.key)&&(t.yo=t.yo.add(e.key))}));var n=[];return e.forEach((function(e){t.yo.has(e)||n.push(new ka(e))})),this.yo.forEach((function(t){e.has(t)||n.push(new ba(t))})),n}},{key:"So",value:function(t){this._o=t.Gn,this.yo=cn();var e=this.Io(t.documents);return this.applyChanges(e,!0)}},{key:"Do",value:function(){return ua.fromInitialDocuments(this.query,this.To,this.mutatedKeys,0===this.mo)}}]),t}(),Oa=function t(e,n,r){Object(v.a)(this,t),this.query=e,this.targetId=n,this.view=r},Ea=function t(e){Object(v.a)(this,t),this.key=e,this.Co=!1},ja=function(){function t(e,n,r,i,a,o){Object(v.a)(this,t),this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.No={},this.xo=new Ar((function(t){return ce(t)}),ue),this.ko=new Map,this.$o=new Set,this.Oo=new Ye(pt.comparator),this.Fo=new Map,this.Mo=new Qr,this.Lo={},this.Bo=new Map,this.Uo=Ir.ie(),this.onlineState="Unknown",this.qo=void 0}return Object(y.a)(t,[{key:"isPrimaryClient",get:function(){return!0===this.qo}}]),t}();function Ta(t,e){return Ia.apply(this,arguments)}function Ia(){return(Ia=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o,s,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=to(e),!(o=r.xo.get(n))){t.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Do(),t.next=15;break;case 6:return t.next=8,Hr(r.localStore,oe(n));case 8:return s=t.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,t.next=13,Sa(r,n,i,"current"===u);case 13:a=t.sent,r.isPrimaryClient&&Ei(r.remoteStore,s);case 15:return t.abrupt("return",a);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sa(t,e,n,r){return xa.apply(this,arguments)}function xa(){return xa=Object(l.a)(c.a.mark((function t(e,n,r,i){var a,o,s,u,h,f;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.Ko=function(t,n,r){return function(){var t=Object(l.a)(c.a.mark((function t(e,n,r,i){var a,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.view.Io(r),t.t0=a.Ln,!t.t0){t.next=6;break}return t.next=5,Gr(e.localStore,n.query,!1).then((function(t){var e=t.documents;return n.view.Io(e,a)}));case 5:a=t.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,e.isPrimaryClient,o),t.abrupt("return",(Ga(e,n.targetId,s.vo),s.snapshot));case 8:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()(e,t,n,r)},t.next=3,Gr(e.localStore,n,!0);case 3:return a=t.sent,o=new wa(n,a.Gn),s=o.Io(a.documents),u=dn.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==e.onlineState),h=o.applyChanges(s,e.isPrimaryClient,u),Ga(e,r,h.vo),f=new Oa(n,r,o),t.abrupt("return",(e.xo.set(n,f),e.ko.has(r)?e.ko.get(r).push(n):e.ko.set(r,[n]),h.snapshot));case 11:case"end":return t.stop()}}),t)}))),xa.apply(this,arguments)}function Aa(t,e){return Ca.apply(this,arguments)}function Ca(){return(Ca=Object(l.a)(c.a.mark((function t(e,n){var r,i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=D(e),i=r.xo.get(n),!((a=r.ko.get(i.targetId)).length>1)){t.next=3;break}return t.abrupt("return",(r.ko.set(i.targetId,a.filter((function(t){return!ue(t,n)}))),void r.xo.delete(n)));case 3:if(!r.isPrimaryClient){t.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),t.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),t.t0){t.next=9;break}return t.next=9,Kr(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),ji(r.remoteStore,i.targetId),Ka(r,i.targetId)})).catch(Sr);case 9:t.next=14;break;case 11:return Ka(r,i.targetId),t.next=14,Kr(r.localStore,i.targetId,!0);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _a(t,e,n){return Na.apply(this,arguments)}function Na(){return(Na=Object(l.a)(c.a.mark((function t(e,n,r){var i,a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=eo(e),t.prev=1,t.next=4,function(t,e){var n,r=D(t),i=W.now(),a=e.reduce((function(t,e){return t.add(e.key)}),cn());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Qn.Pn(t,a).next((function(a){n=a;var o,u=[],c=Object(s.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value,h=Re(l,n.get(l.key));null!=h&&u.push(new Fe(l.key,h,At(h.value.mapValue),Ce.exists(!0)))}}catch(f){c.e(f)}finally{c.f()}return r.In.addMutationBatch(t,i,u,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(i.localStore,n);case 4:return a=t.sent,i.sharedClientState.addPendingMutation(a.batchId),function(t,e,n){var r=t.Lo[t.currentUser.toKey()];r||(r=new Ye(z)),r=r.insert(e,n),t.Lo[t.currentUser.toKey()]=r}(i,a.batchId,r),t.next=9,Xa(i,a.changes);case 9:return t.next=11,Ui(i.remoteStore);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),o=aa(t.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}function Da(t,e){return La.apply(this,arguments)}function La(){return(La=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),t.prev=1,t.next=4,Ur(r.localStore,n);case 4:return i=t.sent,n.targetChanges.forEach((function(t,e){var n=r.Fo.get(e);n&&(N(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?n.Co=!0:t.modifiedDocuments.size>0?N(n.Co):t.removedDocuments.size>0&&(N(n.Co),n.Co=!1))})),t.next=8,Xa(r,i,n);case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(1),t.next=14,Sr(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function Ra(t,e,n){var r=D(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.xo.forEach((function(t,n){var r=n.view.eo(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=D(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){var i,a=Object(s.a)(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.eo(e)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&ga(n)}(r.eventManager,e),i.length&&r.No.Er(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ma(t,e,n){return Pa.apply(this,arguments)}function Pa(){return(Pa=Object(l.a)(c.a.mark((function t(e,n,r){var i,a,o,s,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=D(e)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Fo.get(n),!(o=a&&a.key)){t.next=14;break}return s=(s=new Ye(pt.comparator)).insert(o,Ct.newNoDocument(o,Q.min())),u=cn().add(o),l=new fn(Q.min(),new Map,new Ze(z),s,u),t.next=9,Da(i,l);case 9:i.Oo=i.Oo.remove(o),i.Fo.delete(n),Qa(i),t.next=16;break;case 14:return t.next=16,Kr(i.localStore,n,!1).then((function(){return Ka(i,n,r)})).catch(Sr);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Va(t,e){return Fa.apply(this,arguments)}function Fa(){return(Fa=Object(l.a)(c.a.mark((function t(e,n){var r,i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),i=n.batch.batchId,t.prev=1,t.next=4,Vr(r.localStore,n);case 4:return a=t.sent,Ha(r,i,null),qa(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),t.next=10,Xa(r,a);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,Sr(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function Ua(t,e,n){return Ba.apply(this,arguments)}function Ba(){return(Ba=Object(l.a)(c.a.mark((function t(e,n,r){var i,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=D(e),t.prev=1,t.next=4,function(t,e){var n=D(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.In.lookupMutationBatch(t,e).next((function(e){return N(null!==e),r=e.keys(),n.In.removeMutationBatch(t,e)})).next((function(){return n.In.performConsistencyCheck(t)})).next((function(){return n.Qn.Pn(t,r)}))}))}(i.localStore,n);case 4:return a=t.sent,Ha(i,n,r),qa(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),t.next=10,Xa(i,a);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,Sr(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function qa(t,e){(t.Bo.get(e)||[]).forEach((function(t){t.resolve()})),t.Bo.delete(e)}function Ha(t,e,n){var r=D(t),i=r.Lo[r.currentUser.toKey()];if(i){var a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.Lo[r.currentUser.toKey()]=i}}function Ka(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);var r,i=Object(s.a)(t.ko.get(e));try{for(i.s();!(r=i.n()).done;){var a=r.value;t.xo.delete(a),n&&t.No.jo(a,n)}}catch(o){i.e(o)}finally{i.f()}t.ko.delete(e),t.isPrimaryClient&&t.Mo.cs(e).forEach((function(e){t.Mo.containsKey(e)||za(t,e)}))}function za(t,e){t.$o.delete(e.path.canonicalString());var n=t.Oo.get(e);null!==n&&(ji(t.remoteStore,n),t.Oo=t.Oo.remove(e),t.Fo.delete(n),Qa(t))}function Ga(t,e,n){var r,i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof ba?(t.Mo.addReference(a.key,e),Wa(t,a)):a instanceof ka?(S("SyncEngine","Document no longer in limbo: "+a.key),t.Mo.removeReference(a.key,e),t.Mo.containsKey(a.key)||za(t,a.key)):_()}}catch(o){i.e(o)}finally{i.f()}}function Wa(t,e){var n=e.key,r=n.path.canonicalString();t.Oo.get(n)||t.$o.has(r)||(S("SyncEngine","New document in limbo: "+n),t.$o.add(r),Qa(t))}function Qa(t){for(;t.$o.size>0&&t.Oo.size<t.maxConcurrentLimboResolutions;){var e=t.$o.values().next().value;t.$o.delete(e);var n=new pt(Z.fromString(e)),r=t.Uo.next();t.Fo.set(r,new Ea(n)),t.Oo=t.Oo.insert(n,r),Ei(t.remoteStore,new kr(oe(Zt(n.path)),r,2,q.T))}}function Xa(t,e,n){return Ya.apply(this,arguments)}function Ya(){return Ya=Object(l.a)(c.a.mark((function t(e,n,r){var i,a,o,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=D(e),a=[],o=[],u=[],t.t0=i.xo.isEmpty(),t.t0){t.next=9;break}return i.xo.forEach((function(t,e){u.push(i.Ko(e,n,r).then((function(t){if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(e.targetId,t.fromCache?"not-current":"current"),a.push(t);var n=Nr.kn(e.targetId,t);o.push(n)}})))})),t.next=6,Promise.all(u);case 6:return i.No.Er(a),t.next=9,function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i,a,o,u,l,h,f;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),t.prev=1,t.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return yr.forEach(n,(function(e){return yr.forEach(e.Nn,(function(n){return r.persistence.referenceDelegate.addReference(t,e.targetId,n)})).next((function(){return yr.forEach(e.xn,(function(n){return r.persistence.referenceDelegate.removeReference(t,e.targetId,n)}))}))}))}));case 4:t.next=11;break;case 6:if(t.prev=6,t.t0=t.catch(1),gr(t.t0)){t.next=10;break}throw t.t0;case 10:S("LocalStore","Failed to update sequence numbers: "+t.t0);case 11:i=Object(s.a)(n);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.targetId,o.fromCache||(l=r.Un.get(u),h=l.snapshotVersion,f=l.withLastLimboFreeSnapshotVersion(h),r.Un=r.Un.insert(u,f))}catch(c){i.e(c)}finally{i.f()}case 13:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e,n){return t.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return t.stop()}}),t)}))),Ya.apply(this,arguments)}function Ja(t,e){return $a.apply(this,arguments)}function $a(){return($a=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=D(e)).currentUser.isEqual(n)){t.next=11;break}return S("SyncEngine","User change. New user:",n.toKey()),t.next=5,Mr(r.localStore,n);case 5:return i=t.sent,r.currentUser=n,function(t,e){t.Bo.forEach((function(t){t.forEach((function(t){t.reject(new R(L.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),t.next=11,Xa(r,i.Wn);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Za(t,e){var n=D(t),r=n.Fo.get(e);if(r&&r.Co)return cn().add(r.key);var i=cn(),a=n.ko.get(e);if(!a)return i;var o,u=Object(s.a)(a);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=n.xo.get(c);i=i.unionWith(l.view.Eo)}}catch(h){u.e(h)}finally{u.f()}return i}function to(t){var e=D(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Da.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Za.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ma.bind(null,e),e.No.Er=va.bind(null,e.eventManager),e.No.jo=ya.bind(null,e.eventManager),e}function eo(t){var e=D(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Va.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ua.bind(null,e),e}var no=function(){function t(){Object(v.a)(this,t),this.synchronizeTabs=!1}return Object(y.a)(t,[{key:"initialize",value:function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.N=hi(e.databaseInfo.databaseId),this.sharedClientState=this.Wo(e),this.persistence=this.Go(e),t.next=5,this.persistence.start();case 5:this.gcScheduler=this.zo(e),this.localStore=this.Ho(e);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"zo",value:function(t){return null}},{key:"Ho",value:function(t){return Rr(this.persistence,new Dr,t.initialUser,this.N)}},{key:"Go",value:function(t){return new ti(ni.Ns,this.N)}},{key:"Wo",value:function(t){return new ii}},{key:"terminate",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),t.next=3,this.sharedClientState.shutdown();case 3:return t.next=5,this.persistence.shutdown();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),ro=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"initialize",value:function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.localStore,t.t0){t.next=12;break}return this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Ra(r.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Ja.bind(null,this.syncEngine),t.next=12,ta(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"createEventManager",value:function(t){return new la}},{key:"createDatastore",value:function(t){var e,n=hi(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new ci(e));return function(t,e,n){return new yi(t,e,n)}(t.credentials,r,n)}},{key:"createRemoteStore",value:function(t){var e,n,r,i,a,o=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Ra(o.syncEngine,t,0)},a=oi.bt()?new oi:new ai,new mi(e,n,r,i,a)}},{key:"createSyncEngine",value:function(t,e){return function(t,e,n,r,i,a,o){var s=new ja(t,e,n,r,i,a);return o&&(s.qo=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}},{key:"terminate",value:function(){return function(){var t=Object(l.a)(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=D(e),S("RemoteStore","RemoteStore shutting down."),n.Kr.add(5),t.next=5,wi(n);case 5:n.Qr.shutdown(),n.Wr.set("Unknown");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(this.remoteStore)}}]),t}();var io=function(){function t(e){Object(v.a)(this,t),this.observer=e,this.muted=!1}return Object(y.a)(t,[{key:"next",value:function(t){this.observer.next&&this.Yo(this.observer.next,t)}},{key:"error",value:function(t){this.observer.error?this.Yo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}},{key:"Xo",value:function(){this.muted=!0}},{key:"Yo",value:function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)}}]),t}(),ao=function(){function t(e,n,r){var i=this;Object(v.a)(this,t),this.credentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=E.UNAUTHENTICATED,this.clientId=K.I(),this.credentialListener=function(){return Promise.resolve()},this.credentials.start(n,function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S("FirestoreClient","Received user=",e.uid),t.next=3,i.credentialListener(e);case 3:i.user=e;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}return Object(y.a)(t,[{key:"getConfiguration",value:function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(t){this.credentialListener=t}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new R(L.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new M;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Object(l.a)(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=t.onlineComponents,!n.t0){n.next=5;break}return n.next=5,t.onlineComponents.terminate();case 5:if(n.t1=t.offlineComponents,!n.t1){n.next=9;break}return n.next=9,t.offlineComponents.terminate();case 9:t.credentials.shutdown(),e.resolve(),n.next=17;break;case 13:n.prev=13,n.t2=n.catch(0),r=aa(n.t2,"Failed to shutdown persistence"),e.reject(r);case 17:case"end":return n.stop()}}),n,null,[[0,13]])})))),e.promise}}]),t}();function oo(t,e){return so.apply(this,arguments)}function so(){return so=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider"),t.next=3,e.getConfiguration();case 3:return r=t.sent,t.next=6,n.initialize(r);case 6:i=r.initialUser,e.setCredentialChangeListener(function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=i.isEqual(e),t.t0){t.next=5;break}return t.next=4,Mr(n.localStore,e);case 4:i=e;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return e.terminate()})),e.offlineComponents=n;case 8:case"end":return t.stop()}}),t)}))),so.apply(this,arguments)}function uo(t,e){return co.apply(this,arguments)}function co(){return co=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.asyncQueue.verifyOperationInProgress(),t.next=3,lo(e);case 3:return r=t.sent,S("FirestoreClient","Initializing OnlineComponentProvider"),t.next=7,e.getConfiguration();case 7:return i=t.sent,t.next=10,n.initialize(r,i);case 10:e.setCredentialChangeListener((function(t){return function(){var t=Object(l.a)(c.a.mark((function t(e,n){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=D(e)).asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials"),i=Ai(r),r.Kr.add(3),t.next=6,wi(r);case 6:return i&&r.Wr.set("Unknown"),t.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.Kr.delete(3),t.next=12,bi(r);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n.remoteStore,t)})),e.onlineComponents=n;case 12:case"end":return t.stop()}}),t)}))),co.apply(this,arguments)}function lo(t){return ho.apply(this,arguments)}function ho(){return(ho=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.offlineComponents,t.t0){t.next=5;break}return S("FirestoreClient","Using default OfflineComponentProvider"),t.next=5,oo(e,new no);case 5:return t.abrupt("return",e.offlineComponents);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function fo(t){return po.apply(this,arguments)}function po(){return(po=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.onlineComponents,t.t0){t.next=5;break}return S("FirestoreClient","Using default OnlineComponentProvider"),t.next=5,uo(e,new ro);case 5:return t.abrupt("return",e.onlineComponents);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vo(t){return fo(t).then((function(t){return t.syncEngine}))}function yo(t){return go.apply(this,arguments)}function go(){return(go=Object(l.a)(c.a.mark((function t(e){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fo(e);case 2:return n=t.sent,r=n.eventManager,t.abrupt("return",(r.onListen=Ta.bind(null,n.syncEngine),r.onUnlisten=Aa.bind(null,n.syncEngine),r));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new M;return t.asyncQueue.enqueueAndForget(Object(l.a)(c.a.mark((function i(){return c.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(t,e,n,r,i){var a=new io({next:function(a){e.enqueueAndForget((function(){return da(t,o)}));var s=a.docs.has(n);!s&&a.fromCache?i.reject(new R(L.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new R(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(t){return i.reject(t)}}),o=new ma(Zt(n.path),a,{includeMetadataChanges:!0,uo:!0});return ha(t,o)},i.next=3,yo(t);case 3:return i.t1=i.sent,i.t2=t.asyncQueue,i.t3=e,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function bo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new M;return t.asyncQueue.enqueueAndForget(Object(l.a)(c.a.mark((function i(){return c.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(t,e,n,r,i){var a=new io({next:function(n){e.enqueueAndForget((function(){return da(t,o)})),n.fromCache&&"server"===r.source?i.reject(new R(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),o=new ma(n,a,{includeMetadataChanges:!0,uo:!0});return ha(t,o)},i.next=3,yo(t);case 3:return i.t1=i.sent,i.t2=t.asyncQueue,i.t3=e,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}var ko=function t(e,n,r,i,a,o,s,u){Object(v.a)(this,t),this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u},wo=function(){function t(e,n){Object(v.a)(this,t),this.projectId=e,this.database=n||"(default)"}return Object(y.a)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}]),t}(),Oo=new Map;function Eo(t,e,n){if(!n)throw new R(L.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function jo(t){if(!pt.isDocumentKey(t))throw new R(L.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function To(t){if(pt.isDocumentKey(t))throw new R(L.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function Io(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}return"function"==typeof t?"a function":_()}function So(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new R(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Io(t);throw new R(L.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}return t}var xo=function(){function t(e){var n;if(Object(v.a)(this,t),void 0===e.host){if(void 0!==e.ssl)throw new R(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new R(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(t,e,n,r){if(!0===e&&!0===r)throw new R(L.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return Object(y.a)(t,[{key:"isEqual",value:function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}]),t}(),Ao=function(){function t(e,n){Object(v.a)(this,t),this._credentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xo({}),this._settingsFrozen=!1,e instanceof wo?this._databaseId=e:(this._app=e,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new R(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wo(t.options.projectId)}(e))}return Object(y.a)(t,[{key:"app",get:function(){if(!this._app)throw new R(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(t){if(this._settingsFrozen)throw new R(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xo(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new V;switch(t.type){case"gapi":var e=t.client;return N(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new B(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new R(L.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(t){var e=Oo.get(t);e&&(S("ComponentProvider","Removing Datastore"),Oo.delete(t),e.terminate())}(this),Promise.resolve()}}]),t}();var Co=function(){function t(e,n,r){Object(v.a)(this,t),this.converter=n,this._key=r,this.type="document",this.firestore=e}return Object(y.a)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new No(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),_o=function(){function t(e,n,r){Object(v.a)(this,t),this.converter=n,this._query=r,this.type="query",this.firestore=e}return Object(y.a)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),No=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this,t,r,Zt(i)))._path=i,a.type="collection",a}return Object(y.a)(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Co(this.firestore,null,new pt(t))}},{key:"withConverter",value:function(t){return new n(this.firestore,t,this._path)}}]),n}(_o);function Do(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=Object(k.h)(t),Eo("collection","path",e),t instanceof Ao){var a=Z.fromString.apply(Z,[e].concat(r));return To(a),new No(t,null,a)}if(!(t instanceof Co||t instanceof No))throw new R(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t._path.child(Z.fromString.apply(Z,[e].concat(r)));return To(o),new No(t.firestore,null,o)}function Lo(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=Object(k.h)(t),1===arguments.length&&(e=K.I()),Eo("doc","path",e),t instanceof Ao){var a=Z.fromString.apply(Z,[e].concat(r));return jo(a),new Co(t,null,new pt(a))}if(!(t instanceof Co||t instanceof No))throw new R(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t._path.child(Z.fromString.apply(Z,[e].concat(r)));return jo(o),new Co(t.firestore,t instanceof No?t.converter:null,new pt(o))}var Ro=function(){function t(){var e=this;Object(v.a)(this,t),this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new fi(this,"async_queue_retry"),this.Ta=function(){var t=li();t&&S("AsyncQueue","Visibility state changed to "+t.visibilityState),e.rr.tr()};var n=li();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Ta)}return Object(y.a)(t,[{key:"isShuttingDown",get:function(){return this.wa}},{key:"enqueueAndForget",value:function(t){this.enqueue(t)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(t){this.Ea(),this.Ia(t)}},{key:"enterRestrictedMode",value:function(t){if(!this.wa){this.wa=!0,this.ya=t||!1;var e=li();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ta)}}},{key:"enqueue",value:function(t){var e=this;if(this.Ea(),this.wa)return new Promise((function(){}));var n=new M;return this.Ia((function(){return e.wa&&e.ya?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(t){var e=this;this.enqueueAndForget((function(){return e.da.push(t),e.Aa()}))}},{key:"Aa",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this.da.length){t.next=14;break}return t.prev=1,t.next=4,this.da[0]();case 4:this.da.shift(),this.rr.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),gr(t.t0)){t.next=12;break}throw t.t0;case 12:S("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:this.da.length>0&&this.rr.Xi((function(){return e.Aa()}));case 14:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(){return t.apply(this,arguments)}}()},{key:"Ia",value:function(t){var e=this,n=this.fa.then((function(){return e.ga=!0,t().catch((function(t){e.ma=t,e.ga=!1;var n=function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw x("INTERNAL UNHANDLED ERROR: ",n),t})).then((function(t){return e.ga=!1,t}))}));return this.fa=n,n}},{key:"enqueueAfterDelay",value:function(t,e,n){var r=this;this.Ea(),this.pa.indexOf(t)>-1&&(e=0);var i=ia.createAndSchedule(this,t,e,n,(function(t){return r.Ra(t)}));return this._a.push(i),i}},{key:"Ea",value:function(){this.ma&&_()}},{key:"verifyOperationInProgress",value:function(){}},{key:"ba",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.fa,t.next=3,e;case 3:if(e!==this.fa){t.next=0;break}case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"Pa",value:function(t){var e,n=Object(s.a)(this._a);try{for(n.s();!(e=n.n()).done;){if(e.value.timerId===t)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"va",value:function(t){var e=this;return this.ba().then((function(){e._a.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));var n,r=Object(s.a)(e._a);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==t&&i.timerId===t)break}}catch(a){r.e(a)}finally{r.f()}return e.ba()}))}},{key:"Va",value:function(t){this.pa.push(t)}},{key:"Ra",value:function(t){var e=this._a.indexOf(t);this._a.splice(e,1)}}]),t}();var Mo=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,r)).type="firestore",i._queue=new Ro,i._persistenceKey="name"in t?t.name:"[DEFAULT]",i}return Object(y.a)(n,[{key:"_terminate",value:function(){return this._firestoreClient||Fo(this),this._firestoreClient.terminate()}}]),n}(Ao);function Po(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(g.e)();return Object(g.b)(t,"firestore").getImmediate()}function Vo(t){return t._firestoreClient||Fo(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Fo(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new ko(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new ao(t._credentials,t._queue,r)}var Uo=function(){function t(){Object(v.a)(this,t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new R(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(n)}return Object(y.a)(t,[{key:"isEqual",value:function(t){return this._internalPath.isEqual(t._internalPath)}}]),t}();var Bo=function(){function t(e){Object(v.a)(this,t),this._byteString=e}return Object(y.a)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(t){return this._byteString.isEqual(t._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(rt.fromBase64String(e))}catch(e){throw new R(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(rt.fromUint8Array(e))}}]),t}(),qo=function t(e){Object(v.a)(this,t),this._methodName=e},Ho=function(){function t(e,n){if(Object(v.a)(this,t),!isFinite(e)||e<-90||e>90)throw new R(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new R(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}return Object(y.a)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(t){return this._lat===t._lat&&this._long===t._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(t){return z(this._lat,t._lat)||z(this._long,t._long)}}]),t}(),Ko=/^__.*__$/,zo=function(){function t(e,n,r){Object(v.a)(this,t),this.data=e,this.fieldMask=n,this.fieldTransforms=r}return Object(y.a)(t,[{key:"toMutation",value:function(t,e){return null!==this.fieldMask?new Fe(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ve(t,this.data,e,this.fieldTransforms)}}]),t}();function Go(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _()}}var Wo=function(){function t(e,n,r,i,a,o){Object(v.a)(this,t),this.settings=e,this.databaseId=n,this.N=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Sa(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return Object(y.a)(t,[{key:"path",get:function(){return this.settings.path}},{key:"Da",get:function(){return this.settings.Da}},{key:"Ca",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Na",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ca({path:n,xa:!1});return r.ka(t),r}},{key:"$a",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ca({path:n,xa:!1});return r.Sa(),r}},{key:"Oa",value:function(t){return this.Ca({path:void 0,xa:!0})}},{key:"Fa",value:function(t){return is(t,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}},{key:"contains",value:function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))}},{key:"Sa",value:function(){if(this.path)for(var t=0;t<this.path.length;t++)this.ka(this.path.get(t))}},{key:"ka",value:function(t){if(0===t.length)throw this.Fa("Document fields must not be empty");if(Go(this.Da)&&Ko.test(t))throw this.Fa('Document fields cannot begin and end with "__"')}}]),t}(),Qo=function(){function t(e,n,r){Object(v.a)(this,t),this.databaseId=e,this.ignoreUndefinedProperties=n,this.N=r||hi(e)}return Object(y.a)(t,[{key:"Ba",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Wo({Da:t,methodName:e,La:n,path:et.emptyPath(),xa:!1,Ma:r},this.databaseId,this.N,this.ignoreUndefinedProperties)}}]),t}();function Xo(t){var e=t._freezeSettings(),n=hi(t._databaseId);return new Qo(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yo(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=t.Ba(a.merge||a.mergeFields?2:0,e,n,i);ts("Data must be an object, but it was:",o,r);var u,c,l=$o(r,o);if(a.merge)u=new nt(o.fieldMask),c=o.fieldTransforms;else if(a.mergeFields){var h,f=[],d=Object(s.a)(a.mergeFields);try{for(d.s();!(h=d.n()).done;){var p=h.value,v=es(e,p,n);if(!o.contains(v))throw new R(L.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));as(f,v)||f.push(v)}}catch(y){d.e(y)}finally{d.f()}u=new nt(f),c=o.fieldTransforms.filter((function(t){return u.covers(t.field)}))}else u=null,c=o.fieldTransforms;return new zo(new xt(l),u,c)}function Jo(t,e){if(Zo(t=Object(k.h)(t)))return ts("Unsupported field value:",e,t),$o(t,e);if(t instanceof qo)return function(t,e){if(!Go(e.Da))throw e.Fa("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.Fa("".concat(t._methodName,"() is not currently supported inside arrays"));var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xa&&4!==e.Da)throw e.Fa("Nested arrays are not supported");return function(t,e){var n,r=[],i=0,a=Object(s.a)(t);try{for(a.s();!(n=a.n()).done;){var o=Jo(n.value,e.Oa(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(t,e)}return function(t,e){if(null===(t=Object(k.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ye(e.N,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=W.fromDate(t);return{timestampValue:jn(e.N,n)}}if(t instanceof W){var r=new W(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jn(e.N,r)}}if(t instanceof Ho)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bo)return{bytesValue:Tn(e.N,t._byteString)};if(t instanceof Co){var i=e.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw e.Fa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:xn(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Fa("Unsupported field value: ".concat(Io(t)))}(t,e)}function $o(t,e){var n={};return J(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Y(t,(function(t,r){var i=Jo(r,e.Na(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Zo(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof W||t instanceof Ho||t instanceof Bo||t instanceof Co||t instanceof qo)}function ts(t,e,n){if(!Zo(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Io(n);throw"an object"===r?e.Fa(t+" a custom object"):e.Fa(t+" "+r)}}function es(t,e,n){if((e=Object(k.h)(e))instanceof Uo)return e._internalPath;if("string"==typeof e)return rs(t,e);throw is("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var ns=new RegExp("[~\\*/\\[\\]]");function rs(t,e,n){if(e.search(ns)>=0)throw is("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return Object(r.a)(Uo,Object(p.a)(e.split(".")))._internalPath}catch(i){throw is("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function is(t,e,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(e,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new R(L.INVALID_ARGUMENT,s+t+u)}function as(t,e){return t.some((function(t){return t.isEqual(e)}))}var os=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Object(y.a)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Co(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var t=new ss(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(t){if(this._document){var e=this._document.data.field(us("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}]),t}(),ss=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"data",value:function(){return Object(i.a)(Object(a.a)(n.prototype),"data",this).call(this)}}]),n}(os);function us(t,e){return"string"==typeof e?rs(t,e):e instanceof Uo?e._internalPath:e._delegate._internalPath}var cs=function(){function t(e,n){Object(v.a)(this,t),this.hasPendingWrites=e,this.fromCache=n}return Object(y.a)(t,[{key:"isEqual",value:function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}]),t}(),ls=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t,r,i,a,o,s){var u;return Object(v.a)(this,n),(u=e.call(this,t,r,i,a,s))._firestore=t,u._firestoreImpl=t,u.metadata=o,u}return Object(y.a)(n,[{key:"exists",value:function(){return Object(i.a)(Object(a.a)(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var e=new hs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(us("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}]),n}(os),hs=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(Object(a.a)(n.prototype),"data",this).call(this,t)}}]),n}(ls),fs=function(){function t(e,n,r,i){Object(v.a)(this,t),this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new cs(i.hasPendingWrites,i.fromCache),this.query=r}return Object(y.a)(t,[{key:"docs",get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new hs(n._firestore,n._userDataWriter,r.key,r,new cs(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new R(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new hs(t._firestore,t._userDataWriter,e.doc.key,e.doc,new cs(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new hs(t._firestore,t._userDataWriter,e.doc.key,e.doc,new cs(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,a=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(a=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:ds(e.type),doc:n,oldIndex:i,newIndex:a}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),t}();function ds(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _()}}function ps(t){if(ee(t)&&0===t.explicitOrderBy.length)throw new R(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vs=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"convertValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(vt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ot(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(st(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw _()}}},{key:"convertObject",value:function(t,e){var n=this,r={};return Y(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r}},{key:"convertGeoPoint",value:function(t){return new Ho(ot(t.latitude),ot(t.longitude))}},{key:"convertArray",value:function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))}},{key:"convertServerTimestamp",value:function(t,e){switch(e){case"previous":var n=ct(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(lt(t));default:return null}}},{key:"convertTimestamp",value:function(t){var e=at(t);return new W(e.seconds,e.nanos)}},{key:"convertDocumentKey",value:function(t,e){var n=Z.fromString(t);N(Jn(n));var r=new wo(n.get(1),n.get(3)),i=new pt(n.popFirst(5));return r.isEqual(e)||x("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}]),t}();function ys(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}function gs(t){t=So(t,Co);var e=So(t.firestore,Mo);return mo(Vo(e),t._key).then((function(n){return Es(e,t,n)}))}var ms=function(t){Object(h.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).firestore=t,r}return Object(y.a)(n,[{key:"convertBytes",value:function(t){return new Bo(t)}},{key:"convertReference",value:function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Co(this.firestore,null,e)}}]),n}(vs);function bs(t){t=So(t,_o);var e=So(t.firestore,Mo),n=Vo(e),r=new ms(e);return ps(t._query),bo(n,t._query).then((function(n){return new fs(e,r,t,n)}))}function ks(t,e,n){t=So(t,Co);var r=So(t.firestore,Mo),i=ys(t.converter,e,n);return Os(r,[Yo(Xo(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ce.none())])}function ws(t){return Os(So(t.firestore,Mo),[new ze(t._key,Ce.none())])}function Os(t,e){return function(t,e){var n=new M;return t.asyncQueue.enqueueAndForget(Object(l.a)(c.a.mark((function r(){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=_a,r.next=3,vo(t);case 3:return r.t1=r.sent,r.t2=e,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Vo(t),e)}function Es(t,e,n){var r=n.docs.get(e._key),i=new ms(t);return new ls(t,i,e._key,r,new cs(n.hasPendingWrites,n.fromCache),e.converter)}var js;js=g.a,j=js,Object(g.c)(new m.a("firestore",(function(t,e){var n=e.options,r=t.getProvider("app").getImmediate(),i=new Mo(r,new F(t.getProvider("auth-internal")));return n=Object.assign({useFetchStreams:!0},n),i._setSettings(n),i}),"PUBLIC")),Object(g.g)(O,"3.1.1",undefined),Object(g.g)(O,"3.1.1","esm2017")}).call(this,n(402))},575:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(181),i=n(397);function a(t,e,n){return a=Object(i.a)()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&Object(r.a)(a,n.prototype),a},a.apply(null,arguments)}},587:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(120),i=n(181);var a=n(575);function o(t){var e="function"===typeof Map?new Map:void 0;return o=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return Object(a.a)(t,arguments,Object(r.a)(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Object(i.a)(o,t)},o(t)}},600:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return gr})),n.d(e,"b",(function(){return br})),n.d(e,"c",(function(){return mr})),n.d(e,"d",(function(){return wr})),n.d(e,"e",(function(){return kr})),n.d(e,"f",(function(){return Or})),n.d(e,"g",(function(){return Er})),n.d(e,"h",(function(){return vr})),n.d(e,"i",(function(){return yr}));var r,i=n(549),a=n(562),o=n(120),s=n(174),u=n(175),c=n(172),l=n(173),h="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},f={},d=d||{},p=h||self;function v(){}function y(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var m="closure_uid_"+(1e9*Math.random()>>>0),b=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function O(t,e,n){return(O=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:w).apply(null,arguments)}function E(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function j(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return e.prototype[n].apply(t,i)}}function T(){this.s=this.s,this.o=this.o}var I={};T.prototype.s=!1,T.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++b)}(this);delete I[t]}},T.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},x=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,a=0;a<r;a++)a in i&&e.call(n,i[a],a,t)};function A(t){return Array.prototype.concat.apply([],arguments)}function C(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function _(t){return/^[\s\xa0]*$/.test(t)}var N,D=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function L(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var M=p.navigator;if(M){var P=M.userAgent;if(P){N=P;break t}}N=""}function V(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function F(t){var e={};for(var n in t)e[n]=t[n];return e}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var a=0;a<U.length;a++)n=U[a],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function q(t){return q[" "](t),t}q[" "]=v;var H,K=L(N,"Opera"),z=L(N,"Trident")||L(N,"MSIE"),G=L(N,"Edge"),W=G||z,Q=L(N,"Gecko")&&!(L(N.toLowerCase(),"webkit")&&!L(N,"Edge"))&&!(L(N,"Trident")||L(N,"MSIE"))&&!L(N,"Edge"),X=L(N.toLowerCase(),"webkit")&&!L(N,"Edge");function Y(){var t=p.document;return t?t.documentMode:void 0}t:{var J="",$=function(){var t=N;return Q?/rv:([^\);]+)(\)|;)/.exec(t):G?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):X?/WebKit\/(\S+)/.exec(t):K?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if($&&(J=$?$[1]:""),z){var Z=Y();if(null!=Z&&Z>parseFloat(J)){H=String(Z);break t}}H=J}var tt,et={};function nt(){return function(t){var e=et;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=D(String(H)).split("."),n=D("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var a=e[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;t=R(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||R(0==a[2].length,0==o[2].length)||R(a[2],o[2]),a=a[3],o=o[3]}while(0==t)}return 0<=t}))}if(p.document&&z){var rt=Y();tt=rt||(parseInt(H,10)||void 0)}else tt=void 0;var it=tt,at=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{p.addEventListener("test",v,e),p.removeEventListener("test",v,e)}catch(n){}return t}();function ot(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function st(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Q){t:{try{q(e.nodeName);var i=!0;break t}catch(a){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:ut[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&st.Z.h.call(this)}}ot.prototype.h=function(){this.defaultPrevented=!0},j(st,ot);var ut={2:"touch",3:"pen",4:"mouse"};st.prototype.h=function(){st.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ct="closure_listenable_"+(1e6*Math.random()|0),lt=0;function ht(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++lt,this.ca=this.fa=!1}function ft(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function dt(t){this.src=t,this.g={},this.h=0}function pt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],a=S(i,e);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(ft(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function vt(t,e,n,r){for(var i=0;i<t.length;++i){var a=t[i];if(!a.ca&&a.listener==e&&a.capture==!!n&&a.ia==r)return i}return-1}dt.prototype.add=function(t,e,n,r,i){var a=t.toString();(t=this.g[a])||(t=this.g[a]=[],this.h++);var o=vt(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new ht(e,this.src,a,!!r,i)).fa=n,t.push(e)),e};var yt="closure_lm_"+(1e6*Math.random()|0),gt={};function mt(t,e,n,r,i){if(r&&r.once)return kt(t,e,n,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)mt(t,e[a],n,r,i);return null}return n=St(n),t&&t[ct]?t.N(e,n,g(r)?!!r.capture:!!r,i):bt(t,e,n,!1,r,i)}function bt(t,e,n,r,i,a){if(!e)throw Error("Invalid event type");var o=g(i)?!!i.capture:!!i,s=Tt(t);if(s||(t[yt]=s=new dt(t)),(n=s.add(e,n,r,o,a)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=jt;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)at||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Et(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t,e,n,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)kt(t,e[a],n,r,i);return null}return n=St(n),t&&t[ct]?t.O(e,n,g(r)?!!r.capture:!!r,i):bt(t,e,n,!0,r,i)}function wt(t,e,n,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)wt(t,e[a],n,r,i);else r=g(r)?!!r.capture:!!r,n=St(n),t&&t[ct]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=vt(a=t.g[e],n,r,i))&&(ft(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete t.g[e],t.h--)))):t&&(t=Tt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=vt(e,n,r,i)),(n=-1<t?e[t]:null)&&Ot(n))}function Ot(t){if("number"!==typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ct])pt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Et(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Tt(e))?(pt(n,t),0==n.h&&(n.src=null,e[yt]=null)):ft(t)}}}function Et(t){return t in gt?gt[t]:gt[t]="on"+t}function jt(t,e){if(t.ca)t=!0;else{e=new st(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Ot(t),t=n.call(r,e)}return t}function Tt(t){return(t=t[yt])instanceof dt?t:null}var It="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"===typeof t?t:(t[It]||(t[It]=function(e){return t.handleEvent(e)}),t[It])}function xt(){T.call(this),this.i=new dt(this),this.P=this,this.I=null}function At(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"===typeof e)e=new ot(e,t);else if(e instanceof ot)e.target=e.target||t;else{var i=e;B(e=new ot(r,t),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=e.g=n[a];i=Ct(o,r,!0,e)&&i}if(i=Ct(o=e.g=t,r,!0,e)&&i,i=Ct(o,r,!1,e)&&i,n)for(a=0;a<n.length;a++)i=Ct(o=e.g=n[a],r,!1,e)&&i}function Ct(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var o=e[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&pt(t.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}j(xt,T),xt.prototype[ct]=!0,xt.prototype.removeEventListener=function(t,e,n,r){wt(this,t,e,n,r)},xt.prototype.M=function(){if(xt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ft(n[r]);delete e.g[t],e.h--}}this.I=null},xt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},xt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var _t=p.JSON.stringify;function Nt(){var t=Ut,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Dt,Lt=function(){function t(){Object(c.a)(this,t),this.h=this.g=null}return Object(l.a)(t,[{key:"add",value:function(t,e){var n=Rt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),Rt=new(function(){function t(e,n){Object(c.a)(this,t),this.i=e,this.j=n,this.h=0,this.g=null}return Object(l.a)(t,[{key:"get",value:function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}]),t}())((function(){return new Mt}),(function(t){return t.reset()})),Mt=function(){function t(){Object(c.a)(this,t),this.next=this.g=this.h=null}return Object(l.a)(t,[{key:"set",value:function(t,e){this.h=t,this.g=e,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function Pt(t){p.setTimeout((function(){throw t}),0)}function Vt(t,e){Dt||function(){var t=p.Promise.resolve(void 0);Dt=function(){t.then(Bt)}}(),Ft||(Dt(),Ft=!0),Ut.add(t,e)}var Ft=!1,Ut=new Lt;function Bt(){for(var t;t=Nt();){try{t.h.call(t.g)}catch(n){Pt(n)}var e=Rt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ft=!1}function qt(t,e){xt.call(this),this.h=t||1,this.g=e||p,this.j=O(this.kb,this),this.l=Date.now()}function Ht(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Kt(t,e,n){if("function"===typeof t)n&&(t=O(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=O(t.handleEvent,t)}return 2147483647<Number(e)?-1:p.setTimeout(t,e||0)}function zt(t){t.g=Kt((function(){t.g=null,t.i&&(t.i=!1,zt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}j(qt,xt),(r=qt.prototype).da=!1,r.S=null,r.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),At(this,"tick"),this.da&&(Ht(this),this.start()))}},r.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},r.M=function(){qt.Z.M.call(this),Ht(this),delete this.g};var Gt=function(t){Object(s.a)(n,t);var e=Object(u.a)(n);function n(t,r){var i;return Object(c.a)(this,n),(i=e.call(this)).m=t,i.j=r,i.h=null,i.i=!1,i.g=null,i}return Object(l.a)(n,[{key:"l",value:function(t){this.h=arguments,this.g?this.i=!0:zt(this)}},{key:"M",value:function(){Object(a.a)(Object(o.a)(n.prototype),"M",this).call(this),this.g&&(p.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(T);function Wt(t){T.call(this),this.h=t,this.g={}}j(Wt,T);var Qt=[];function Xt(t,e,n,r){Array.isArray(n)||(n&&(Qt[0]=n.toString()),n=Qt);for(var i=0;i<n.length;i++){var a=mt(e,n[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}}function Yt(t){V(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ot(t)}),t),t.g={}}function Jt(){this.g=!0}function $t(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return _t(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}Wt.prototype.M=function(){Wt.Z.M.call(this),Yt(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Jt.prototype.Aa=function(){this.g=!1},Jt.prototype.info=function(){};var Zt={},te=null;function ee(){return te=te||new xt}function ne(t){ot.call(this,Zt.Ma,t)}function re(t){var e=ee();At(e,new ne(e,t))}function ie(t,e){ot.call(this,Zt.STAT_EVENT,t),this.stat=e}function ae(t){var e=ee();At(e,new ie(e,t))}function oe(t,e){ot.call(this,Zt.Na,t),this.size=e}function se(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return p.setTimeout((function(){t()}),e)}Zt.Ma="serverreachability",j(ne,ot),Zt.STAT_EVENT="statevent",j(ie,ot),Zt.Na="timingevent",j(oe,ot);var ue={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ce={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function le(){}function he(t){return t.h||(t.h=t.i())}function fe(){}le.prototype.h=null;var de,pe={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ve(){ot.call(this,"d")}function ye(){ot.call(this,"c")}function ge(){}function me(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Wt(this),this.P=ke,t=W?125:void 0,this.W=new qt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new be}function be(){this.i=null,this.g="",this.h=!1}j(ve,ot),j(ye,ot),j(ge,le),ge.prototype.g=function(){return new XMLHttpRequest},ge.prototype.i=function(){return{}},de=new ge;var ke=45e3,we={},Oe={};function Ee(t,e,n){t.K=1,t.v=Ge(Ue(e)),t.s=n,t.U=!0,je(t,null)}function je(t,e){t.F=Date.now(),xe(t),t.A=Ue(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),on(n.h,"t",r),t.C=0,n=t.l.H,t.h=new be,t.g=ur(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Gt(O(t.Ia,t,t.g),t.O)),Xt(t.V,t.g,"readystatechange",t.gb),e=t.H?F(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),re(1),function(t,e,n,r,i,a){t.info((function(){if(t.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Te(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ie(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Se(t,n))==Oe){4==e&&(t.o=4,ae(14),i=!1),$t(t.j,t.m,null,"[Incomplete Response]");break}if(r==we){t.o=4,ae(15),$t(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}$t(t.j,t.m,r,null),De(t,r)}Te(t)&&r!=Oe&&r!=we&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ae(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.L=!0,ae(11))):($t(t.j,t.m,n,"[Invalid Chunked Response]"),Ne(t),_e(t))}function Se(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Oe:(n=Number(e.substring(n,r)),isNaN(n)?we:(r+=1)+n>e.length?Oe:(e=e.substr(r,n),t.C=r+n,e))}function xe(t){t.Y=Date.now()+t.P,Ae(t,t.P)}function Ae(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=se(O(t.eb,t),e)}function Ce(t){t.B&&(p.clearTimeout(t.B),t.B=null)}function _e(t){0==t.l.G||t.I||rr(t.l,t)}function Ne(t){Ce(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ht(t.W),Yt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function De(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||pn(n.i,t)))if(n.I=t.N,!t.J&&pn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;nr(n),zn(n)}Zn(n),ae(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=se(O(n.ab,n),6e3));if(1>=dn(n.i)&&n.ka){try{n.ka()}catch(a){}n.ka=void 0}}else ar(n,11)}else if((t.J||n.g==t)&&nr(n),!_(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var a=i[e];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(L(l,"spdy")||L(l,"quic")||L(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(vn(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ze(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=sr(r,r.H?r.la:null,r.W),d.J){yn(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(Ce(p),xe(p)),r.g=d}else $n(r);0<n.l.length&&Qn(n)}else"stop"!=a[0]&&"close"!=a[0]||ar(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?ar(n,7):Kn(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}re(4)}catch(a){}}function Le(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(y(t)||"string"===typeof t)x(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(y(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"===typeof t)return t.split("");if(y(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var a=0;a<i;a++)e.call(void 0,r[a],n&&n[a],t)}}function Re(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Re)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Me(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Pe(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Pe(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Pe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(r=me.prototype).setTimeout=function(t){this.P=t},r.gb=function(t){t=t.target;var e=this.L;e&&3==Fn(t)?e.l():this.Ia(t)},r.Ia=function(t){try{if(t==this.g)t:{var e=Fn(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||W||this.g&&(this.h.h||this.g.ga()||Un(this.g)))){this.I||4!=e||7==n||re(8==n||0>=r?3:2),Ce(this);var i=this.g.ba();this.N=i;e:if(Te(this)){var a=Un(this.g);t="";var o=a.length,s=4==Fn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ne(this),_e(this);var u="";break e}this.h.i=new p.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,a,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,ae(12),Ne(this),_e(this);break t}$t(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,De(this,i)}this.U?(Ie(this,e,u),W&&this.i&&3==e&&(Xt(this.V,this.W,"tick",this.fb),this.W.start())):($t(this.j,this.m,u,null),De(this,u)),4==e&&Ne(this),this.i&&!this.I&&(4==e?rr(this.l,this):(this.i=!1,xe(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,ae(12)):(this.o=0,ae(13)),Ne(this),_e(this)}}}catch(e){}},r.fb=function(){if(this.g){var t=Fn(this.g),e=this.g.ga();this.C<e.length&&(Ce(this),Ie(this,t,e),this.i&&4!=t&&xe(this))}},r.cancel=function(){this.I=!0,Ne(this)},r.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(re(3),ae(17)),Ne(this),this.o=2,_e(this)):Ae(this,this.Y-t)},(r=Re.prototype).R=function(){Me(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},r.T=function(){return Me(this),this.g.concat()},r.get=function(t,e){return Pe(this.h,t)?this.h[t]:e},r.set=function(t,e){Pe(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},r.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);t.call(e,a,i,this)}};var Ve=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fe(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Fe){this.g=void 0!==e?e:t.g,Be(this,t.j),this.s=t.s,qe(this,t.i),He(this,t.m),this.l=t.l,e=t.h;var n=new en;n.i=e.i,e.g&&(n.g=new Re(e.g),n.h=e.h),Ke(this,n),this.o=t.o}else t&&(n=String(t).match(Ve))?(this.g=!!e,Be(this,n[1]||"",!0),this.s=We(n[2]||""),qe(this,n[3]||"",!0),He(this,n[4]),this.l=We(n[5]||"",!0),Ke(this,n[6]||"",!0),this.o=We(n[7]||"")):(this.g=!!e,this.h=new en(null,this.g))}function Ue(t){return new Fe(t)}function Be(t,e,n){t.j=n?We(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function qe(t,e,n){t.i=n?We(e,!0):e}function He(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ke(t,e,n){e instanceof en?(t.h=e,function(t,e){e&&!t.j&&(nn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(rn(this,e),on(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Qe(e,Ze)),t.h=new en(e,t.g))}function ze(t,e,n){t.h.set(e,n)}function Ge(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function We(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qe(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,Xe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Xe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Qe(e,Ye,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Qe(e,Ye,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Qe(n,"/"==n.charAt(0)?$e:Je,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Qe(n,tn)),t.join("")};var Ye=/[#\/\?@]/g,Je=/[#\?:]/g,$e=/[#\?]/g,Ze=/[#\?@]/g,tn=/#/g;function en(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function nn(t){t.g||(t.g=new Re,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var a=t[n].substring(0,r);i=t[n].substring(r+1)}else a=t[n];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function rn(t,e){nn(t),e=sn(t,e),Pe(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Pe((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Me(t)))}function an(t,e){return nn(t),e=sn(t,e),Pe(t.g.h,e)}function on(t,e,n){rn(t,e),0<n.length&&(t.i=null,t.g.set(sn(t,e),C(n)),t.h+=n.length)}function sn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(r=en.prototype).add=function(t,e){nn(this),this.i=null,t=sn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},r.forEach=function(t,e){nn(this),this.g.forEach((function(n,r){x(n,(function(n){t.call(e,n,r,this)}),this)}),this)},r.T=function(){nn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],a=0;a<i.length;a++)n.push(e[r]);return n},r.R=function(t){nn(this);var e=[];if("string"===typeof t)an(this,t)&&(e=A(e,this.g.get(sn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=A(e,t[n])}return e},r.set=function(t,e){return nn(this),this.i=null,an(this,t=sn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},r.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),t.push(o)}}return this.i=t.join("&")};var un=function t(e,n){Object(c.a)(this,t),this.h=e,this.g=n};function cn(t){this.l=t||hn,p.PerformanceNavigationTiming?t=0<(t=p.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(p.g&&p.g.Ea&&p.g.Ea()&&p.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ln,hn=10;function fn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function dn(t){return t.h?1:t.g?t.g.size:0}function pn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function vn(t,e){t.g?t.g.add(e):t.h=e}function yn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function gn(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var e,n=t.i,r=Object(i.a)(t.g.values());try{for(r.s();!(e=r.n()).done;){var a=e.value;n=n.concat(a.D)}}catch(o){r.e(o)}finally{r.f()}return n}return C(t.i)}function mn(){}function bn(){this.g=new mn}function kn(t,e,n){var r=n||"";try{Le(t,(function(t,n){var i=t;g(t)&&(i=_t(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function wn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(a){}}function On(t){this.l=t.$b||null,this.j=t.ib||!1}function En(t,e){xt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=jn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}cn.prototype.cancel=function(){if(this.i=gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var t,e=Object(i.a)(this.g.values());try{for(e.s();!(t=e.n()).done;){t.value.cancel()}}catch(n){e.e(n)}finally{e.f()}this.g.clear()}},mn.prototype.stringify=function(t){return p.JSON.stringify(t,void 0)},mn.prototype.parse=function(t){return p.JSON.parse(t,void 0)},j(On,le),On.prototype.g=function(){return new En(this.l,this.j)},On.prototype.i=(ln={},function(){return ln}),j(En,xt);var jn=0;function Tn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function In(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sn(t)}function Sn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(r=En.prototype).open=function(t,e){if(this.readyState!=jn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sn(this)},r.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||p).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},r.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,In(this)),this.readyState=jn},r.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof p.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Tn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},r.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?In(this):Sn(this),3==this.readyState&&Tn(this)}},r.Ua=function(t){this.g&&(this.response=this.responseText=t,In(this))},r.Ta=function(t){this.g&&(this.response=t,In(this))},r.ha=function(){this.g&&In(this)},r.setRequestHeader=function(t,e){this.v.append(t,e)},r.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(En.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var xn=p.JSON.parse;function An(t){xt.call(this),this.headers=new Re,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Cn,this.K=this.L=!1}j(An,xt);var Cn="",_n=/^https?$/i,Nn=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function Ln(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Rn(t),Pn(t)}function Rn(t){t.D||(t.D=!0,At(t,"complete"),At(t,"error"))}function Mn(t){if(t.h&&"undefined"!=typeof d&&(!t.C[1]||4!=Fn(t)||2!=t.ba()))if(t.v&&4==Fn(t))Kt(t.Fa,0,t);else if(At(t,"readystatechange"),4==Fn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.H).match(Ve)[1]||null;if(!a&&p.self&&p.self.location){var o=p.self.location.protocol;a=o.substr(0,o.length-1)}i=!_n.test(a?a.toLowerCase():"")}e=i}if(e)At(t,"complete"),At(t,"success");else{t.m=6;try{var s=2<Fn(t)?t.g.statusText:""}catch(u){s=""}t.j=s+" ["+t.ba()+"]",Rn(t)}}finally{Pn(t)}}}function Pn(t,e){if(t.g){Vn(t);var n=t.g,r=t.C[0]?v:null;t.g=null,t.C=null,e||At(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Vn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(p.clearTimeout(t.A),t.A=null)}function Fn(t){return t.g?t.g.readyState:0}function Un(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Cn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return V(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.za=0,this.l=[],this.h=new Jt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=qn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=qn("baseRetryDelayMs",5e3,t),this.$a=qn("retryDelaySeedMs",1e4,t),this.Ya=qn("forwardChannelMaxRetries",2,t),this.ra=qn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new cn(t&&t.concurrentRequestLimit),this.Ca=new bn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Kn(t){if(Gn(t),3==t.G){var e=t.V++,n=Ue(t.F);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),Yn(t,n),(e=new me(t,t.h,e,void 0)).K=2,e.v=Ge(Ue(n)),n=!1,p.navigator&&p.navigator.sendBeacon&&(n=p.navigator.sendBeacon(e.v.toString(),"")),!n&&p.Image&&((new Image).src=e.v,n=!0),n||(e.g=ur(e.l,null),e.g.ea(e.v)),e.F=Date.now(),xe(e)}or(t)}function zn(t){t.g&&(tr(t),t.g.cancel(),t.g=null)}function Gn(t){zn(t),t.u&&(p.clearTimeout(t.u),t.u=null),nr(t),t.i.cancel(),t.m&&("number"===typeof t.m&&p.clearTimeout(t.m),t.m=null)}function Wn(t,e){t.l.push(new un(t.Za++,e)),3==t.G&&Qn(t)}function Qn(t){fn(t.i)||t.m||(t.m=!0,Vt(t.Ha,t),t.C=0)}function Xn(t,e){var n;n=e?e.m:t.V++;var r=Ue(t.F);ze(r,"SID",t.J),ze(r,"RID",n),ze(r,"AID",t.U),Yn(t,r),t.o&&t.s&&Bn(r,t.o,t.s),n=new me(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),vn(t.i,n),Ee(n,r,e)}function Yn(t,e){t.j&&Le({},(function(t,n){ze(e,n,t)}))}function Jn(t,e,n){n=Math.min(t.l.length,n);var r=t.j?O(t.j.Oa,t.j,t):null;t:for(var i=t.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{kn(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function $n(t){t.g||t.u||(t.Y=1,Vt(t.Ga,t),t.A=0)}function Zn(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=se(O(t.Ga,t),ir(t,t.A)),t.A++,!0)}function tr(t){null!=t.B&&(p.clearTimeout(t.B),t.B=null)}function er(t){t.g=new me(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ue(t.oa);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.N?"0":"1"),ze(e,"AID",t.U),Yn(t,e),ze(e,"TYPE","xmlhttp"),t.o&&t.s&&Bn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Ge(Ue(e)),n.s=null,n.U=!0,je(n,t)}function nr(t){null!=t.v&&(p.clearTimeout(t.v),t.v=null)}function rr(t,e){var n=null;if(t.g==e){nr(t),tr(t),t.g=null;var r=2}else{if(!pn(t.i,e))return;n=e.D,yn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;At(r=ee(),new oe(r,n,e,i)),Qn(t)}else $n(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(dn(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=se(O(t.Ha,t,e),ir(t,t.C)),t.C++,!0))}(t,e)||2==r&&Zn(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ir(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function ar(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=O(t.jb,t);n||(n=new Fe("//www.google.com/images/cleardot.gif"),p.location&&"http"==p.location.protocol||Be(n,"https"),Ge(n)),function(t,e){var n=new Jt;if(p.Image){var r=new Image;r.onload=E(wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=E(wn,n,r,"TestLoadImage: error",!1,e),r.onabort=E(wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=E(wn,n,r,"TestLoadImage: timeout",!1,e),p.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else ae(2);t.G=0,t.j&&t.j.va(e),or(t),Gn(t)}function or(t){t.G=0,t.I=-1,t.j&&(0==gn(t.i).length&&0==t.l.length||(t.i.i.length=0,C(t.l),t.l.length=0),t.j.ua())}function sr(t,e,n){var r=function(t){return t instanceof Fe?Ue(t):new Fe(t,void 0)}(n);if(""!=r.i)e&&qe(r,e+"."+r.i),He(r,r.m);else{var i=p.location;r=function(t,e,n,r){var i=new Fe(null,void 0);return t&&Be(i,t),e&&qe(i,e),n&&He(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&V(t.aa,(function(t,e){ze(r,e,t)})),e=t.D,n=t.sa,e&&n&&ze(r,e,n),ze(r,"VER",t.ma),Yn(t,r),r}function ur(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new An(new On({ib:!0})):new An(t.qa)).L=t.H,e}function cr(){}function lr(){if(z&&!(10<=Number(it)))throw Error("Environmental error: no available transport.")}function hr(t,e){xt.call(this),this.g=new Hn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!_(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new pr(this)}function fr(t){ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function dr(){ye.call(this),this.status=1}function pr(t){this.g=t}(r=An.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():de.g(),this.C=this.u?he(this.u):he(de),this.g.onreadystatechange=O(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(a){return void Ln(this,a)}t=n||"";var i=new Re(this.headers);r&&Le(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Dn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(i.T()),n=p.FormData&&t instanceof p.FormData,!(0<=S(Nn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Vn(this),0<this.B&&((this.K=function(t){return z&&nt()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=O(this.pa,this)):this.A=Kt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(a){Ln(this,a)}},r.pa=function(){"undefined"!=typeof d&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,At(this,"timeout"),this.abort(8))},r.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,At(this,"complete"),At(this,"abort"),Pn(this))},r.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pn(this,!0)),An.Z.M.call(this)},r.Fa=function(){this.s||(this.F||this.v||this.l?Mn(this):this.cb())},r.cb=function(){Mn(this)},r.ba=function(){try{return 2<Fn(this)?this.g.status:-1}catch(ln){return-1}},r.ga=function(){try{return this.g?this.g.responseText:""}catch(ln){return""}},r.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},r.Da=function(){return this.m},r.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(r=Hn.prototype).ma=8,r.G=1,r.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},r.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new me(this,this.h,t,void 0),n=this.s;if(this.P&&(n?B(n=F(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"===typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Jn(this,e,r),ze(i=Ue(this.F),"RID",t),ze(i,"CVER",22),this.D&&ze(i,"X-HTTP-Session-Id",this.D),Yn(this,i),this.o&&n&&Bn(i,this.o,n),vn(this.i,e),this.Ra&&ze(i,"TYPE","init"),this.ja?(ze(i,"$req",r),ze(i,"SID","null"),e.$=!0,Ee(e,i,null)):Ee(e,i,r),this.G=2}}else 3==this.G&&(t?Xn(this,t):0==this.l.length||fn(this.i)||Xn(this))},r.Ga=function(){if(this.u=null,er(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=se(O(this.bb,this),t)}},r.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ae(10),zn(this),er(this))},r.ab=function(){null!=this.v&&(this.v=null,zn(this),Zn(this),ae(19))},r.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ae(2)):(this.h.info("Failed to ping google.com"),ae(1))},(r=cr.prototype).xa=function(){},r.wa=function(){},r.va=function(){},r.ua=function(){},r.Oa=function(){},lr.prototype.g=function(t,e){return new hr(t,e)},j(hr,xt),hr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Vt(O(t.hb,t,e))),ae(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=sr(t,null,t.W),Qn(t)},hr.prototype.close=function(){Kn(this.g)},hr.prototype.u=function(t){if("string"===typeof t){var e={};e.__data__=t,Wn(this.g,e)}else this.v?((e={}).__data__=_t(t),Wn(this.g,e)):Wn(this.g,t)},hr.prototype.M=function(){this.g.j=null,delete this.j,Kn(this.g),delete this.g,hr.Z.M.call(this)},j(fr,ve),j(dr,ye),j(pr,cr),pr.prototype.xa=function(){At(this.g,"a")},pr.prototype.wa=function(t){At(this.g,new fr(t))},pr.prototype.va=function(t){At(this.g,new dr(t))},pr.prototype.ua=function(){At(this.g,"b")},lr.prototype.createWebChannel=lr.prototype.g,hr.prototype.send=hr.prototype.u,hr.prototype.open=hr.prototype.m,hr.prototype.close=hr.prototype.close,ue.NO_ERROR=0,ue.TIMEOUT=8,ue.HTTP_ERROR=6,ce.COMPLETE="complete",fe.EventType=pe,pe.OPEN="a",pe.CLOSE="b",pe.ERROR="c",pe.MESSAGE="d",xt.prototype.listen=xt.prototype.N,An.prototype.listenOnce=An.prototype.O,An.prototype.getLastError=An.prototype.La,An.prototype.getLastErrorCode=An.prototype.Da,An.prototype.getStatus=An.prototype.ba,An.prototype.getResponseJson=An.prototype.Qa,An.prototype.getResponseText=An.prototype.ga,An.prototype.send=An.prototype.ea;var vr=f.createWebChannelTransport=function(){return new lr},yr=f.getStatEventTarget=function(){return ee()},gr=f.ErrorCode=ue,mr=f.EventType=ce,br=f.Event=Zt,kr=f.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},wr=f.FetchXmlHttpFactory=On,Or=f.WebChannel=fe,Er=f.XhrIo=An}).call(this,n(51))},601:function(t,e,n){"use strict";var r=n(551);n.d(e,"a",(function(){return r.f}));Object(r.g)("firebase","9.1.3","app")},602:function(t,e,n){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,a=new Promise((function(a,o){n(i=t[e].apply(t,r)).then(a,o)}));return a.request=i,a}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function a(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function o(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}function v(t,e,n){var i=r(indexedDB,"open",[t,e]),a=i.request;return a&&(a.onupgradeneeded=function(t){n&&n(new d(a.result,t.oldVersion,a.transaction))}),i.then((function(t){return new p(t)}))}function y(t){return r(indexedDB,"deleteDatabase",[t])}a(c,"_index",["name","keyPath","multiEntry","unique"]),o(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),a(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},a(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},a(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},a(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},a(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,a=i[t].apply(i,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=v,t.deleteDb=y,Object.defineProperty(t,"__esModule",{value:!0})}(e)},631:function(t,e,n){"use strict";n.d(e,"a",(function(){return ke}));var r,i=n(547),a=n(549),o=n(172),s=n(173),u=n(179),c=n(542),l=n.n(c),h=n(543),f=n(551),d=n(567),p=n(550),v=n(557),y=n(561),g=n(602),m="@firebase/installations",b="0.5.2",k=1e4,w="w:".concat(b),O="FIS_v2",E=36e5,j=(r={},Object(u.a)(r,"missing-app-config-values",'Missing App configuration value: "{$valueName}"'),Object(u.a)(r,"not-registered","Firebase Installation is not registered."),Object(u.a)(r,"installation-not-found","Firebase Installation not found."),Object(u.a)(r,"request-failed",'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"'),Object(u.a)(r,"app-offline","Could not process request. Application offline."),Object(u.a)(r,"delete-pending-registration","Can't delete installation while there is a pending registration request."),r),T=new p.b("installations","Installations",j);function I(t){return t instanceof p.c&&t.code.includes("request-failed")}function S(t){var e=t.projectId;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(e,"/installations")}function x(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function A(t,e){return C.apply(this,arguments)}function C(){return(C=Object(h.a)(l.a.mark((function t(e,n){var r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:return r=t.sent,i=r.error,t.abrupt("return",T.create("request-failed",{requestName:e,serverCode:i.code,serverMessage:i.message,serverStatus:i.status}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function N(t,e){var n=e.refreshToken,r=_(t);return r.append("Authorization",function(t){return"".concat(O," ").concat(t)}(n)),r}function D(t){return L.apply(this,arguments)}function L(){return(L=Object(h.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:if(!((n=t.sent).status>=500&&n.status<600)){t.next=5;break}return t.abrupt("return",e());case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(t,e){return M.apply(this,arguments)}function M(){return(M=Object(h.a)(l.a.mark((function t(e,n){var r,i,a,o,s,u,c,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.fid,i=S(e),a=_(e),o={fid:r,authVersion:O,appId:e.appId,sdkVersion:w},s={method:"POST",headers:a,body:JSON.stringify(o)},t.next=7,D((function(){return fetch(i,s)}));case 7:if(!(u=t.sent).ok){t.next=16;break}return t.next=11,u.json();case 11:return c=t.sent,h={fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:x(c.authToken)},t.abrupt("return",h);case 16:return t.next=18,A("Create Installation",u);case 18:throw t.sent;case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function P(t){return new Promise((function(e){setTimeout(e,t)}))}var V=/^[cdef][\w-]{21}$/;function F(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,Object(y.a)(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return V.test(e)?e:""}catch(n){return""}}function U(t){return"".concat(t.appName,"!").concat(t.appId)}var B=new Map;function q(t,e){var n=U(t);H(n,e),function(t,e){var n=z();n&&n.postMessage({key:t,fid:e});G()}(n,e)}function H(t,e){var n=B.get(t);if(n){var r,i=Object(a.a)(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(e)}}catch(o){i.e(o)}finally{i.f()}}}var K=null;function z(){return!K&&"BroadcastChannel"in self&&((K=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){H(t.data.key,t.data.fid)}),K}function G(){0===B.size&&K&&(K.close(),K=null)}var W="firebase-installations-store",Q=null;function X(){return Q||(Q=Object(g.openDb)("firebase-installations-database",1,(function(t){if(0===t.oldVersion)t.createObjectStore(W)}))),Q}function Y(t,e){return J.apply(this,arguments)}function J(){return(J=Object(h.a)(l.a.mark((function t(e,n){var r,i,a,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=U(e),t.next=3,X();case 3:return i=t.sent,a=i.transaction(W,"readwrite"),o=a.objectStore(W),t.next=8,o.get(r);case 8:return s=t.sent,t.next=11,o.put(n,r);case 11:return t.next=13,a.complete;case 13:return s&&s.fid===n.fid||q(e,n.fid),t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(t){return Z.apply(this,arguments)}function Z(){return(Z=Object(h.a)(l.a.mark((function t(e){var n,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=U(e),t.next=3,X();case 3:return r=t.sent,i=r.transaction(W,"readwrite"),t.next=7,i.objectStore(W).delete(n);case 7:return t.next=9,i.complete;case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tt(t,e){return et.apply(this,arguments)}function et(){return(et=Object(h.a)(l.a.mark((function t(e,n){var r,i,a,o,s,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=U(e),t.next=3,X();case 3:return i=t.sent,a=i.transaction(W,"readwrite"),o=a.objectStore(W),t.next=8,o.get(r);case 8:if(s=t.sent,void 0!==(u=n(s))){t.next=15;break}return t.next=13,o.delete(r);case 13:t.next=17;break;case 15:return t.next=17,o.put(u,r);case 17:return t.next=19,a.complete;case 19:return!u||s&&s.fid===u.fid||q(e,u.fid),t.abrupt("return",u);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(t){return rt.apply(this,arguments)}function rt(){return(rt=Object(h.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,tt(e,(function(t){var r=it(t),i=at(e,r);return n=i.registrationPromise,i.installationEntry}));case 2:if(""!==(r=t.sent).fid){t.next=8;break}return t.next=6,n;case 6:return t.t0=t.sent,t.abrupt("return",{installationEntry:t.t0});case 8:return t.abrupt("return",{installationEntry:r,registrationPromise:n});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(t){return lt(t||{fid:F(),registrationStatus:0})}function at(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(T.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function(t,e){return ot.apply(this,arguments)}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:st(t)}:{installationEntry:e}}function ot(){return(ot=Object(h.a)(l.a.mark((function t(e,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R(e,n);case 3:return r=t.sent,t.abrupt("return",Y(e,r));case 7:if(t.prev=7,t.t0=t.catch(0),!I(t.t0)||409!==t.t0.customData.serverCode){t.next=14;break}return t.next=12,$(e);case 12:t.next=16;break;case 14:return t.next=16,Y(e,{fid:n.fid,registrationStatus:0});case 16:throw t.t0;case 17:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function st(t){return ut.apply(this,arguments)}function ut(){return(ut=Object(h.a)(l.a.mark((function t(e){var n,r,i,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ct(e);case 2:n=t.sent;case 3:if(1!==n.registrationStatus){t.next=11;break}return t.next=6,P(100);case 6:return t.next=8,ct(e);case 8:n=t.sent,t.next=3;break;case 11:if(0!==n.registrationStatus){t.next=22;break}return t.next=14,nt(e);case 14:if(r=t.sent,i=r.installationEntry,!(a=r.registrationPromise)){t.next=21;break}return t.abrupt("return",a);case 21:return t.abrupt("return",i);case 22:return t.abrupt("return",n);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ct(t){return tt(t,(function(t){if(!t)throw T.create("installation-not-found");return lt(t)}))}function lt(t){return 1===(e=t).registrationStatus&&e.registrationTime+k<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function ht(t,e){return ft.apply(this,arguments)}function ft(){return(ft=Object(h.a)(l.a.mark((function t(e,n){var r,i,a,o,s,u,c,h,f,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.appConfig,i=e.platformLoggerProvider,a=dt(r,n),o=N(r,n),(s=i.getImmediate({optional:!0}))&&o.append("x-firebase-client",s.getPlatformInfoString()),u={installation:{sdkVersion:w}},c={method:"POST",headers:o,body:JSON.stringify(u)},t.next=9,D((function(){return fetch(a,c)}));case 9:if(!(h=t.sent).ok){t.next=18;break}return t.next=13,h.json();case 13:return f=t.sent,d=x(f),t.abrupt("return",d);case 18:return t.next=20,A("Generate Auth Token",h);case 20:throw t.sent;case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(t,e){var n=e.fid;return"".concat(S(t),"/").concat(n,"/authTokens:generate")}function pt(t){return vt.apply(this,arguments)}function vt(){return vt=Object(h.a)(l.a.mark((function t(e){var n,r,i,a,o=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],t.next=3,tt(e.appConfig,(function(t){if(!wt(t))throw T.create("not-registered");var i=t.authToken;if(!n&&Ot(i))return t;if(1===i.requestStatus)return r=yt(e,n),t;if(!navigator.onLine)throw T.create("app-offline");var a=Et(t);return r=bt(e,a),a}));case 3:if(i=t.sent,!r){t.next=10;break}return t.next=7,r;case 7:t.t0=t.sent,t.next=11;break;case 10:t.t0=i.authToken;case 11:return a=t.t0,t.abrupt("return",a);case 13:case"end":return t.stop()}}),t)}))),vt.apply(this,arguments)}function yt(t,e){return gt.apply(this,arguments)}function gt(){return(gt=Object(h.a)(l.a.mark((function t(e,n){var r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,mt(e.appConfig);case 2:r=t.sent;case 3:if(1!==r.authToken.requestStatus){t.next=11;break}return t.next=6,P(100);case 6:return t.next=8,mt(e.appConfig);case 8:r=t.sent,t.next=3;break;case 11:if(0!==(i=r.authToken).requestStatus){t.next=16;break}return t.abrupt("return",pt(e,n));case 16:return t.abrupt("return",i);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(t){return tt(t,(function(t){if(!wt(t))throw T.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+k<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t}))}function bt(t,e){return kt.apply(this,arguments)}function kt(){return(kt=Object(h.a)(l.a.mark((function t(e,n){var r,i,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ht(e,n);case 3:return r=t.sent,i=Object.assign(Object.assign({},n),{authToken:r}),t.next=7,Y(e.appConfig,i);case 7:return t.abrupt("return",r);case 10:if(t.prev=10,t.t0=t.catch(0),!I(t.t0)||401!==t.t0.customData.serverCode&&404!==t.t0.customData.serverCode){t.next=17;break}return t.next=15,$(e.appConfig);case 15:t.next=20;break;case 17:return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),t.next=20,Y(e.appConfig,a);case 20:throw t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function wt(t){return void 0!==t&&2===t.registrationStatus}function Ot(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+E}(t)}function Et(t){var e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function jt(){return(jt=Object(h.a)(l.a.mark((function t(e){var n,r,i,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,t.next=3,nt(n.appConfig);case 3:return r=t.sent,i=r.installationEntry,(a=r.registrationPromise)?a.catch(console.error):pt(n).catch(console.error),t.abrupt("return",i.fid);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Tt(){return Tt=Object(h.a)(l.a.mark((function t(e){var n,r,i,a=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],r=e,t.next=4,It(r.appConfig);case 4:return t.next=6,pt(r,n);case 6:return i=t.sent,t.abrupt("return",i.token);case 8:case"end":return t.stop()}}),t)}))),Tt.apply(this,arguments)}function It(t){return St.apply(this,arguments)}function St(){return(St=Object(h.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt(e);case 2:if(n=t.sent,!(r=n.registrationPromise)){t.next=7;break}return t.next=7,r;case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xt(t){return T.create("missing-app-config-values",{valueName:t})}var At,Ct="installations",_t=function(t){var e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw xt("App Configuration");if(!t.name)throw xt("App Name");for(var e=0,n=["projectId","apiKey","appId"];e<n.length;e++){var r=n[e];if(!t.options[r])throw xt(r)}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,platformLoggerProvider:Object(f.b)(e,"platform-logger"),_delete:function(){return Promise.resolve()}}},Nt=function(t){var e=t.getProvider("app").getImmediate(),n=Object(f.b)(e,Ct).getImmediate(),r={getId:function(){return function(t){return jt.apply(this,arguments)}(n)},getToken:function(t){return function(t){return Tt.apply(this,arguments)}(n,t)}};return r};Object(f.c)(new v.a(Ct,_t,"PUBLIC")),Object(f.c)(new v.a("installations-internal",Nt,"PRIVATE")),Object(f.g)(m,b),Object(f.g)(m,b,"esm2017");var Dt="analytics",Lt=6e4,Rt="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Mt="https://www.googletagmanager.com/gtag/js",Pt=new d.b("@firebase/analytics");function Vt(t){return Promise.all(t.map((function(t){return t.catch((function(t){return t}))})))}function Ft(t,e){var n=document.createElement("script");n.src="".concat(Mt,"?l=").concat(t,"&id=").concat(e),n.async=!0,document.head.appendChild(n)}function Ut(t,e,n,r,i,a){return Bt.apply(this,arguments)}function Bt(){return(Bt=Object(h.a)(l.a.mark((function t(e,n,r,i,a,o){var s,u,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=i[a],t.prev=1,!s){t.next=7;break}return t.next=5,n[s];case 5:t.next=14;break;case 7:return t.next=9,Vt(r);case 9:if(u=t.sent,!(c=u.find((function(t){return t.measurementId===a})))){t.next=14;break}return t.next=14,n[c.appId];case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),Pt.error(t.t0);case 19:e("config",a,o);case 20:case"end":return t.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}function qt(t,e,n,r,i){return Ht.apply(this,arguments)}function Ht(){return(Ht=Object(h.a)(l.a.mark((function t(e,n,r,i,o){var s,u,c,h,f,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=[],!o||!o.send_to){t.next=26;break}return u=o.send_to,Array.isArray(u)||(u=[u]),t.next=7,Vt(r);case 7:c=t.sent,h=Object(a.a)(u),t.prev=9,d=function(){var t=f.value,e=c.find((function(e){return e.measurementId===t})),r=e&&n[e.appId];if(!r)return s=[],"break";s.push(r)},h.s();case 12:if((f=h.n()).done){t.next=18;break}if("break"!==d()){t.next=16;break}return t.abrupt("break",18);case 16:t.next=12;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(9),h.e(t.t0);case 23:return t.prev=23,h.f(),t.finish(23);case 26:return 0===s.length&&(s=Object.values(n)),t.next=29,Promise.all(s);case 29:e("event",i,o||{}),t.next=35;break;case 32:t.prev=32,t.t1=t.catch(0),Pt.error(t.t1);case 35:case"end":return t.stop()}}),t,null,[[0,32],[9,20,23,26]])})))).apply(this,arguments)}function Kt(t,e,n,r,i){var a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(a=window[i]),window[i]=function(t,e,n,r){function i(){return(i=Object(h.a)(l.a.mark((function i(a,o,s){return l.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,qt(t,e,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,Ut(t,e,n,r,o,s);case 9:i.next=12;break;case 11:t("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),Pt.error(i.t0);case 17:case"end":return i.stop()}}),i,null,[[0,14]])})))).apply(this,arguments)}return function(t,e,n){return i.apply(this,arguments)}}(a,t,e,n),{gtagCore:a,wrappedGtag:window[i]}}function zt(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(Mt))return r}return null}var Gt=(At={},Object(u.a)(At,"already-exists","A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId."),Object(u.a)(At,"already-initialized","initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance."),Object(u.a)(At,"already-initialized-settings","Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect."),Object(u.a)(At,"interop-component-reg-failed","Firebase Analytics Interop Component failed to instantiate: {$reason}"),Object(u.a)(At,"invalid-analytics-context","Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),Object(u.a)(At,"indexeddb-unavailable","IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),Object(u.a)(At,"fetch-throttle","The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}."),Object(u.a)(At,"config-fetch-failed","Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}"),Object(u.a)(At,"no-api-key",'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.'),Object(u.a)(At,"no-app-id",'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'),At),Wt=new p.b("analytics","Analytics",Gt),Qt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(o.a)(this,t),this.throttleMetadata=e,this.intervalMillis=n}return Object(s.a)(t,[{key:"getThrottleMetadata",value:function(t){return this.throttleMetadata[t]}},{key:"setThrottleMetadata",value:function(t,e){this.throttleMetadata[t]=e}},{key:"deleteThrottleMetadata",value:function(t){delete this.throttleMetadata[t]}}]),t}(),Xt=new Qt;function Yt(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function Jt(t){return $t.apply(this,arguments)}function $t(){return($t=Object(h.a)(l.a.mark((function t(e){var n,r,i,a,o,s,u,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.appId,i=e.apiKey,a={method:"GET",headers:Yt(i)},o=Rt.replace("{app-id}",r),t.next=5,fetch(o,a);case 5:if(200===(s=t.sent).status||304===s.status){t.next=18;break}return u="",t.prev=8,t.next=11,s.json();case 11:c=t.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(8);case 17:throw Wt.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 18:return t.abrupt("return",s.json());case 19:case"end":return t.stop()}}),t,null,[[8,15]])})))).apply(this,arguments)}function Zt(t){return te.apply(this,arguments)}function te(){return te=Object(h.a)(l.a.mark((function t(e){var n,r,i,a,o,s,u,c,f=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:Xt,r=f.length>2?f[2]:void 0,i=e.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){t.next=5;break}throw Wt.create("no-app-id");case 5:if(o){t.next=9;break}if(!s){t.next=8;break}return t.abrupt("return",{measurementId:s,appId:a});case 8:throw Wt.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new ae,setTimeout(Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.abort();case 1:case"end":return t.stop()}}),t)}))),void 0!==r?r:Lt),t.abrupt("return",ee({appId:a,apiKey:o,measurementId:s},u,c,n));case 13:case"end":return t.stop()}}),t)}))),te.apply(this,arguments)}function ee(t,e,n){return ne.apply(this,arguments)}function ne(){return ne=Object(h.a)(l.a.mark((function t(e,n,r){var i,a,o,s,u,c,h,f,d=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=d.length>3&&void 0!==d[3]?d[3]:Xt,s=e.appId,u=e.measurementId,t.prev=3,t.next=6,re(r,i);case 6:t.next=14;break;case 8:if(t.prev=8,t.t0=t.catch(3),!u){t.next=13;break}return Pt.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(t.t0.message,"]")),t.abrupt("return",{appId:s,measurementId:u});case 13:throw t.t0;case 14:return t.prev=14,t.next=17,Jt(e);case 17:return c=t.sent,o.deleteThrottleMetadata(s),t.abrupt("return",c);case 22:if(t.prev=22,t.t1=t.catch(14),ie(t.t1)){t.next=32;break}if(o.deleteThrottleMetadata(s),!u){t.next=31;break}return Pt.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(t.t1.message,"]")),t.abrupt("return",{appId:s,measurementId:u});case 31:throw t.t1;case 32:return h=503===Number(t.t1.customData.httpStatus)?Object(p.e)(a,o.intervalMillis,30):Object(p.e)(a,o.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:a+1},o.setThrottleMetadata(s,f),Pt.debug("Calling attemptFetch again in ".concat(h," millis")),t.abrupt("return",ee(e,f,r,o));case 37:case"end":return t.stop()}}),t,null,[[3,8],[14,22]])}))),ne.apply(this,arguments)}function re(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),a=setTimeout(n,i);t.addEventListener((function(){clearTimeout(a),r(Wt.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}function ie(t){if(!(t instanceof p.c)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}var ae=function(){function t(){Object(o.a)(this,t),this.listeners=[]}return Object(s.a)(t,[{key:"addEventListener",value:function(t){this.listeners.push(t)}},{key:"abort",value:function(){this.listeners.forEach((function(t){return t()}))}}]),t}();function oe(){return se.apply(this,arguments)}function se(){return(se=Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(p.m)()){t.next=5;break}return Pt.warn(Wt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),t.abrupt("return",!1);case 5:return t.prev=5,t.next=8,Object(p.r)();case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(5),Pt.warn(Wt.create("indexeddb-unavailable",{errorInfo:t.t0}).message),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,null,[[5,10]])})))).apply(this,arguments)}function ue(){return(ue=Object(h.a)(l.a.mark((function t(e,n,r,a,o,s,u){var c,h,f,d,p,v,y,g;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(h=Zt(e)).then((function(t){r[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Pt.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Pt.error(t)})),n.push(h),f=oe().then((function(t){return t?a.getId():void 0})),t.next=6,Promise.all([h,f]);case 6:return d=t.sent,p=Object(i.a)(d,2),v=p[0],y=p[1],zt()||Ft(s,v.measurementId),o("js",new Date),(g=null!==(c=null===u||void 0===u?void 0:u.config)&&void 0!==c?c:{}).origin="firebase",g.update=!0,null!=y&&(g.firebase_id=y),o("config",v.measurementId,g),t.abrupt("return",v.measurementId);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ce,le,he=function(){function t(e){Object(o.a)(this,t),this.app=e}return Object(s.a)(t,[{key:"_delete",value:function(){return delete fe[this.app.options.appId],Promise.resolve()}}]),t}(),fe={},de=[],pe={},ve="dataLayer",ye="gtag",ge=!1;function me(t,e,n){!function(){var t=[];if(Object(p.j)()&&t.push("This is a browser extension environment."),Object(p.d)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"(".concat(e+1,") ").concat(t)})).join(" "),n=Wt.create("invalid-analytics-context",{errorInfo:e});Pt.warn(n.message)}}();var r=t.options.appId;if(!r)throw Wt.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Wt.create("no-api-key");Pt.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(t.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=fe[r])throw Wt.create("already-exists",{id:r});if(!ge){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(ve);var i=Kt(fe,de,pe,ve,ye),a=i.wrappedGtag,o=i.gtagCore;le=a,ce=o,ge=!0}return fe[r]=function(t,e,n,r,i,a,o){return ue.apply(this,arguments)}(t,de,pe,e,ce,ve,n),new he(t)}function be(){return(be=Object(h.a)(l.a.mark((function t(e,n,r,i,a){var o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a||!a.global){t.next=5;break}return e("event",r,i),t.abrupt("return");case 5:return t.next=7,n;case 7:o=t.sent,s=Object.assign(Object.assign({},i),{send_to:o}),e("event",r,s);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ke(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(f.e)();t=Object(p.h)(t);var e=Object(f.b)(t,Dt);return e.isInitialized()?e.getImmediate():we(t)}function we(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(f.b)(t,Dt);if(n.isInitialized()){var r=n.getImmediate();if(Object(p.g)(e,n.getOptions()))return r;throw Wt.create("already-initialized")}var i=n.initialize({options:e});return i}function Oe(t,e,n,r){t=Object(p.h)(t),function(t,e,n,r,i){return be.apply(this,arguments)}(le,fe[t.app.options.appId],e,n,r).catch((function(t){return Pt.error(t)}))}var Ee="@firebase/analytics",je="0.7.2";Object(f.c)(new v.a(Dt,(function(t,e){var n=e.options;return me(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Object(f.c)(new v.a("analytics-internal",(function(t){try{var e=t.getProvider(Dt).getImmediate();return{logEvent:function(t,n,r){return Oe(e,t,n,r)}}}catch(n){throw Wt.create("interop-component-reg-failed",{reason:n})}}),"PRIVATE")),Object(f.g)(Ee,je),Object(f.g)(Ee,je,"esm2017")},635:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M469.666,216.45,271.078,33.749a34,34,0,0,0-47.062.98L41.373,217.373,32,226.745V496H208V328h96V496H480V225.958ZM248.038,56.771c.282,0,.108.061-.013.18C247.9,56.832,247.756,56.771,248.038,56.771ZM448,464H336V328a32,32,0,0,0-32-32H208a32,32,0,0,0-32,32V464H64V240L248.038,57.356c.013-.012.014-.023.024-.035L448,240Z' class='ci-primary'/>"]},636:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["511.974 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,48a208.064,208.064,0,0,1,80.953,399.668A208.062,208.062,0,0,1,175.047,64.333,206.659,206.659,0,0,1,256,48m0-32C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.549,496,256,388.548,16,256,16Z' class='ci-primary'/><rect width='35' height='35' x='257' y='103' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M269.709,408a50.06,50.06,0,0,1-48.026-64.186l35.67-121.277a17.577,17.577,0,0,0-33.1-11.7l-11.718,28.234-29.557-12.265L194.7,198.574a49.577,49.577,0,0,1,93.353,32.992l-35.67,121.278A18.06,18.06,0,0,0,269.709,376a18.123,18.123,0,0,0,15.6-8.966l15.1-25.915,27.646,16.115-15.1,25.913A50.225,50.225,0,0,1,269.709,408Z' class='ci-primary'/>"]},637:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"]},638:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M462.541,316.3l-64.344-42.1,24.774-45.418A79.124,79.124,0,0,0,432.093,192V120A103.941,103.941,0,0,0,257.484,43.523L279.232,67a71.989,71.989,0,0,1,120.861,53v72a46.809,46.809,0,0,1-5.215,21.452L355.962,284.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421V432h-72v32h104V378.494A74.061,74.061,0,0,0,462.541,316.3Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M318.541,348.3l-64.343-42.1,24.773-45.418A79.124,79.124,0,0,0,288.093,224V152A104.212,104.212,0,0,0,184.04,47.866C126.723,47.866,80.093,94.581,80.093,152v72a78,78,0,0,0,9.015,36.775l24.908,45.664L50.047,348.3A74.022,74.022,0,0,0,16.5,410.4L16,496H352.093V410.494A74.061,74.061,0,0,0,318.541,348.3ZM320.093,464H48.186l.31-53.506a42.158,42.158,0,0,1,19.073-35.421l88.682-58.029L117.2,245.452A46.838,46.838,0,0,1,112.093,224V152a72,72,0,1,1,144,0v72a46.809,46.809,0,0,1-5.215,21.452L211.962,316.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421Z' class='ci-primary'/>"]},639:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>"]},640:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M411.6,343.656l-72.823-47.334,27.455-50.334A80.23,80.23,0,0,0,376,207.681V128a112,112,0,0,0-224,0v79.681a80.236,80.236,0,0,0,9.768,38.308l27.455,50.333L116.4,343.656A79.725,79.725,0,0,0,80,410.732V496H448V410.732A79.727,79.727,0,0,0,411.6,343.656ZM416,464H112V410.732a47.836,47.836,0,0,1,21.841-40.246l97.66-63.479-41.64-76.341A48.146,48.146,0,0,1,184,207.681V128a80,80,0,0,1,160,0v79.681a48.146,48.146,0,0,1-5.861,22.985L296.5,307.007l97.662,63.479h0A47.836,47.836,0,0,1,416,410.732Z' class='ci-primary'/>"]},641:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M408.157,464.286h-360v-368h240l32-32h-280a24.028,24.028,0,0,0-24,24v384a24.027,24.027,0,0,0,24,24h376a24.027,24.027,0,0,0,24-24v-272l-32,32Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M478.4,33.6a60.16,60.16,0,0,0-84.983,0L190.751,236.267l-19.923,84.07-.145.677a17.341,17.341,0,0,0,20.294,20.305l84.757-20.07L478.4,118.584A60.16,60.16,0,0,0,478.4,33.6ZM455.772,95.957,259.524,292.2l-52.067,12.339L219.8,252.477,416.043,56.228a28.093,28.093,0,0,1,39.729,39.729Z' class='ci-primary'/>"]},642:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256.25,16.042c-132.548,0-240,107.451-240,240s107.452,240,240,240,240-107.452,240-240S388.8,16.042,256.25,16.042ZM403.328,403.12A207.253,207.253,0,1,1,447.917,337,207.364,207.364,0,0,1,403.328,403.12Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='239.637 164.987 314.69 240.041 128.137 240.041 128.137 272.041 314.69 272.041 239.637 347.095 262.264 369.722 375.945 256.041 262.264 142.36 239.637 164.987' class='ci-primary'/>"]},643:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,16.042c-132.548,0-240,107.451-240,240s107.452,240,240,240,240-107.452,240-240S388.548,16.042,256,16.042ZM403.078,403.12A207.253,207.253,0,1,1,447.667,337,207.364,207.364,0,0,1,403.078,403.12Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='272.614 164.987 249.986 142.36 136.305 256.041 249.986 369.722 272.614 347.095 197.56 272.041 385 272.041 385 240.041 197.56 240.041 272.614 164.987' class='ci-primary'/>"]},644:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144a128,128,0,0,0-256,0v56H88V328c0,92.635,75.364,168,168,168s168-75.365,168-168V200ZM160,144a96,96,0,0,1,192,0v56H160ZM392,328c0,74.99-61.01,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>"]}}]);
//# sourceMappingURL=6.edc0381d.chunk.js.map